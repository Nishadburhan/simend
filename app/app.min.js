var app=angular.module("simDiary",["ui.router","ngSanitize","ui.bootstrap","angular-flot","angular-peity","cgNotify","chart.js","ngAnimate","ui.map","ui.calendar","summernote","ngGrid","ui.tree","bm.bsTour","datatables","xeditable","ui.select","ui.sortable","ui.footable","angular-chartist","gridshore.c3js.chart","datatables.buttons","angular-ladda","ui.codemirror","cfp.loadingBar","angularjs-dropdown-multiselect"]);app.config(["$stateProvider","$urlRouterProvider","$compileProvider","cfpLoadingBarProvider",function(e,t,n,o){o.includeSpinner=!1,o.includeBar=!0,n.debugInfoEnabled(!1),t.otherwise("/dashboard"),e.state("landing",{url:"/landing_page",templateUrl:"views/landing_page.html",data:{pageTitle:"Landing page",specialClass:"landing-page"}}).state("dashboard",{url:"/dashboard",templateUrl:"views/dashboard.html",controller:"dashboardCtrl",data:{pageTitle:"Dashboard"}}).state("quotation",{url:"/quotation",templateUrl:"views/quotation/list.php",controller:"quotationCtrl",data:{pageTitle:"Quotation"}}).state("project",{url:"/project",templateUrl:"views/project/list.php",controller:"projectCtrl",data:{pageTitle:"Project"}}).state("reports",{url:"/reports",templateUrl:"views/report/list.php",data:{pageTitle:"Reports"}}).state("report",{abstract:!0,url:"/report",templateUrl:"views/common/content.html",data:{pageTitle:"Report"}}).state("employee_report",{url:"/employee_report",templateUrl:"views/report/report.html",controller:"reportCtrl",data:{pageTitle:"Project"}}).state("quotation_report",{url:"/quotation_report",templateUrl:"views/report/report.html",controller:"quotationReportCtrl",data:{pageTitle:"Quotation Report"}}).state("project_report",{url:"/project_report",templateUrl:"views/report/report.html",controller:"projectReportCtrl",data:{pageTitle:"Project Report"}}).state("job_report",{url:"/job_report",templateUrl:"views/report/report.html",controller:"jobReportCtrl",data:{pageTitle:"Job Report"}}).state("job_schedule_report",{url:"/job_schedule_report",templateUrl:"views/report/report.html",controller:"jobScheduleCtrl",data:{pageTitle:"Schedule Report"}}).state("jobs",{abstract:!0,url:"/jobs",templateUrl:"views/common/content.html",data:{pageTitle:"Settings"}}).state("jobs.job",{url:"/job",templateUrl:"views/jobs/list.php",controller:"jobsCtrl",data:{pageTitle:"Job"}}).state("jobs.schedule",{url:"/schedule",controller:"scheduleCtrl",templateUrl:"views/schedule/lists.php",data:{pageTitle:"Schedules"}}).state("jobs.jobsheet",{url:"/jobsheet",controller:"jobsheetsCtrl",templateUrl:"views/jobsheet/list.php",data:{pageTitle:"Jobsheet"}}).state("jobs.expensesheet",{url:"/expensesheet",controller:"expsheetCtrl",templateUrl:"views/expensesheet/list.php",data:{pageTitle:"Expense Sheet"}}).state("jobs.tasks",{url:"/tasks",controller:"taskCtrl",templateUrl:"views/tasks/list.php",data:{pageTitle:"Tasks"}}).state("invoice",{url:"/invoice",controller:"invoiceCtrl",templateUrl:"views/invoice/list.php",data:{pageTitle:"Invoice"}}).state("company_setup",{abstract:!0,url:"/company_setup",templateUrl:"views/common/content.html",data:{pageTitle:"Interface"}}).state("company_setup.profile",{url:"/profile",templateUrl:"views/company/profile.php",controller:"profileCtrl",data:{pageTitle:"ProfIle"}}).state("company_setup.branches",{url:"/branches",templateUrl:"views/branch/list.php",controller:"branchCtrl",data:{pageTitle:"Branches"}}).state("company_setup.departments",{url:"/departments",templateUrl:"views/department/list.php",controller:"departmentCtrl",data:{pageTitle:"Departments"}}).state("company_setup.employees",{url:"/employees",templateUrl:"views/employee/list.php",controller:"employeeCtrl",data:{pageTitle:"Employees"}}).state("company_setup.designations",{url:"/designations",templateUrl:"views/designation/list.php",controller:"designationCtrl",data:{pageTitle:"Designations"}}).state("company_setup.service",{url:"/service",templateUrl:"views/service/list.php",controller:"serviceCtrl",data:{pageTitle:"Servcies"}}).state("company_setup.customers",{url:"/customers",templateUrl:"views/customer/list.php",controller:"customerCtrl",data:{pageTitle:"Customers"}}).state("company_setup.jobsite",{url:"/jobsite",templateUrl:"views/jobsite/list.php",controller:"jobsiteCtrl",data:{pageTitle:"Jobsite"}}).state("utilities",{abstract:!0,url:"/utilities",templateUrl:"views/common/content.html",data:{pageTitle:"Utilities"}}).state("utilities.reminders",{url:"/reminders",templateUrl:"views/reminder/list.php",controller:"reminderCtrl",data:{pageTitle:"Reminders"}}).state("utilities.contactbook",{url:"/contactbook",templateUrl:"views/contactbook/list.php",controller:"contactCtrl",data:{pageTitle:"ContactBook"}}).state("settings",{abstract:!0,url:"/settings",templateUrl:"views/common/content.html",data:{pageTitle:"Settings"}}).state("settings.configuration",{url:"/configuration",templateUrl:"views/config/list.php",controller:"configCtrl",data:{pageTitle:"Configuration"}}).state("settings.role",{url:"/role",templateUrl:"views/role/userrole.php",controller:"roleCtrl",data:{pageTitle:"UserRole"}}).state("settings.user",{url:"/users",templateUrl:"views/users/users.php",controller:"UserCtrl",data:{pageTitle:"User"}}).state("settings.template",{url:"/template",templateUrl:"views/template/list.php",controller:"templateCtrl",data:{pageTitle:"Template"}}).state("settings.notification",{url:"/notification",templateUrl:"views/notification/list.php",controller:"notificationCtrl",data:{pageTitle:"notification"}}).state("settings.trash",{url:"/trash",templateUrl:"views/trash/list.php",controller:"trashCtrl",data:{pageTitle:"Trash"}}).state("access",{url:"/access",templateUrl:"views/access/access.html",data:{pageTitle:"Access Denied"}})}]),app.run(["$rootScope","$state","editableOptions",function(e,t,n){e.$state=t,n.theme="bs3",e.timedropdown=[],e.selectedin="",e.selectedout="";for(var o=0;o<1440;o++)h=parseInt(o/60),h<10&&(h="0"+h),m=o%60,m<10&&(m="0"+m),e.timedropdown.push(h+":"+m)}]),app.controller("appCtrl",["$http","$scope","$timeout","$window",function(e,t,n,o){t.checkOne=!0}]),app.directive("findTotem",function(){return{restrict:"A",require:"ngModel",scope:{unit:"=",rate:"=",freq:"="},link:function(e,t,n,o){t.bind("keydown",function(e){e.preventDefault()})}}}),app.directive("parseNum",function(){return{require:"ngModel",link:function(e,t,n,o){o.$parsers.push(function(e){return""+e}),o.$formatters.push(function(e){return parseFloat(e)})}}}),app.directive("convertToNumber",function(){return{require:"ngModel",link:function(e,t,n,o){o.$parsers.push(function(e){return null!=e?parseInt(e,10):null}),o.$formatters.push(function(e){return null!=e?""+e:null})}}}),app.directive("pageTitle",["$rootScope","$timeout",function(e,t){return{link:function(n,o){e.$on("$stateChangeStart",function(e,n,i,r,a){var s="SIM | Service Industry Management System";n.data&&n.data.pageTitle&&(s="SIM | "+n.data.pageTitle),t(function(){o.text(s)})})}}}]),app.directive("sideNavigation",["$timeout",function(e){return{restrict:"A",link:function(e,t){t.metisMenu(),$('#side-menu a:not([href$="\\#"])').click(function(){$(window).width()<769&&$("body").toggleClass("show-sidebar")}),$("body").hasClass("sidebar-scroll")&&t.parent().slimScroll({height:"100%",opacity:.3,size:0,wheelStep:5,allowPageScroll:!0})}}}]),app.directive("minimalizaMenu",["$rootScope",function(e){return{restrict:"EA",template:'<div class="header-link hide-menu" ng-click="minimalize()"><i class="fa fa-bars"></i></div>',controller:function(e,t){e.minimalize=function(){$(window).width()<769?$("body").toggleClass("show-sidebar"):$("body").toggleClass("hide-sidebar")}}}}]),app.directive("sparkline",function(){return{restrict:"A",scope:{sparkData:"=",sparkOptions:"="},link:function(e,t,n){e.$watch(e.sparkData,function(){o()}),e.$watch(e.sparkOptions,function(){o()});var o=function(){$(t).sparkline(e.sparkData,e.sparkOptions)}}}}),app.directive("icheck",["$timeout",function(e){return{restrict:"A",require:"ngModel",link:function(t,n,o,i){return e(function(){var e;return e=o.value,t.$watch(o.ngModel,function(e){$(n).iCheck("update")}),$(n).iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green"}).on("ifChanged",function(r){if("checkbox"===$(n).attr("type")&&o.ngModel&&t.$apply(function(){return i.$setViewValue(r.target.checked)}),"radio"===$(n).attr("type")&&o.ngModel)return t.$apply(function(){return i.$setViewValue(e)})})})}}}]),app.directive("panelTools",["$timeout",function(e){return{restrict:"A",scope:!0,templateUrl:"views/common/panel_tools.html",controller:function(t,n){t.showhide=function(){var t=n.closest("div.hpanel"),o=n.find("i:first"),i=t.find("div.panel-body"),r=t.find("div.panel-footer");i.slideToggle(300),r.slideToggle(200),o.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),t.toggleClass("").toggleClass("panel-collapse"),e(function(){t.resize(),t.find("[id^=map-]").resize()},50)},t.closebox=function(){n.closest("div.hpanel").remove()}}}}]),app.directive("panelToolsFullscreen",["$timeout",function(e){return{restrict:"A",scope:!0,templateUrl:"views/common/panel_tools_fullscreen.html",controller:function(t,n){t.showhide=function(){var t=n.closest("div.hpanel"),o=n.find("i:first"),i=t.find("div.panel-body"),r=t.find("div.panel-footer");i.slideToggle(300),r.slideToggle(200),o.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),t.toggleClass("").toggleClass("panel-collapse"),e(function(){t.resize(),t.find("[id^=map-]").resize()},50)},t.closebox=function(){n.closest("div.hpanel").remove(),$("body").hasClass("fullscreen-panel-mode")&&$("body").removeClass("fullscreen-panel-mode")},t.fullscreen=function(){var e=n.closest("div.hpanel"),t=n.find("i:first");$("body").toggleClass("fullscreen-panel-mode"),t.toggleClass("fa-expand").toggleClass("fa-compress"),e.toggleClass("fullscreen"),setTimeout(function(){$(window).trigger("resize")},100)}}}}]),app.directive("smallHeader",function(){return{restrict:"A",scope:!0,controller:function(e,t){e.small=function(){var e=t.find("i:first"),n=t.find("#hbreadcrumb");t.toggleClass("small-header"),n.toggleClass("m-t-lg"),e.toggleClass("fa-arrow-up").toggleClass("fa-arrow-down")}}}}),app.directive("animatePanel",["$timeout","$state",function(e,t){return{restrict:"A",link:function(n,o,i){var r=.06,a=Math.abs(r)+0;t.current.name;i.effect||(i.effect="zoomIn"),r=i.delay?i.delay/10:.06,i.child?i.child="."+i.child:i.child=".row > div";var s=o.find(i.child);s.addClass("opacity-0");s.length;e(function(){(s=o.find(i.child)).addClass("stagger").addClass("animated-panel").addClass(i.effect);var t=(s.length+10)*r*1e4/10;s.each(function(e,t){a+=r;var n=Math.round(10*a)/10;$(t).css("animation-delay",n+"s"),$(t).removeClass("opacity-0")}),e(function(){$(".stagger").css("animation",""),$(".stagger").removeClass(i.effect).removeClass("animated-panel").removeClass("stagger"),s.resize()},t)})}}}]),app.directive("landingScrollspy",function(){return{restrict:"A",link:function(e,t,n){t.scrollspy({target:".navbar-fixed-top",offset:80})}}}),app.directive("clockPicker",function(){return{restrict:"A",link:function(e,t){t.clockpicker()}}}),app.directive("dateTimePicker",function(){return{require:"?ngModel",restrict:"AE",scope:{pick12HourFormat:"@",language:"@",useCurrent:"@",location:"@"},link:function(e,t,n){t.datetimepicker({pick12HourFormat:e.pick12HourFormat,language:e.language,useCurrent:e.useCurrent}),t.on("blur",function(){})}}}),app.directive("touchSpin",function(){return{restrict:"A",scope:{spinOptions:"="},link:function(e,t,n){e.$watch(e.spinOptions,function(){o()});var o=function(){$(t).TouchSpin(e.spinOptions)}}}}),app.directive("datepicker",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,o){var i=function(t){e.$apply(function(){o.$setViewValue(t)})},r={dateFormat:"yy-mm-dd",onSelect:function(e){i(e)}};t.datepicker(r)}}}),app.directive("redirector",["$state","$rootScope",function(e,t){return{restrict:"AC",scope:{module:"="},link:function(t,n){n.bind("click",function(){switch(console.log(t.module),angular.element(n).addClass("active"),console.log(t.module),t.module){case 163:e.go("quotation");break;case 165:e.go("project");break;case 167:e.go("jobs.job"),t.$root.statusvalue=!0;break;case 191:e.go("invoice")}})}}}]),app.directive("permissionchange",["$state","AccessFactory","Data","$rootScope",function(e,t,n,o){return{restrict:"AC",scope:{module:"="},link:function(o,i){i.bind("click",function(){o.$root.disabled=!1,t.Perission(o.module).then(function(t){console.log(n.get(t)),0==n.get(t)&&e.go("access"),1==n.get(t)&&(o.$root.disabled=!0),2==n.get(t)&&(o.$root.deletehide=!0),3==n.get(t)&&(o.$root.disabled=!1,o.$root.deletehide=!1)},function(e){})})}}}]),app.filter("propsFilter",function(){return function(e,t){var n=[];return angular.isArray(e)?e.forEach(function(e){for(var o=!1,i=Object.keys(t),r=0;r<i.length;r++){var a=i[r],s=t[a].toLowerCase();if(-1!==e[a].toString().toLowerCase().indexOf(s)){o=!0;break}}o&&n.push(e)}):n=e,n}}),app.filter("fSum",function(){return function(e,t){var n=0;for(i=0;i<e.length;i++)n+=Number(e[i].esdamount);return n}}),app.filter("capitalize",function(){return function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}),app.filter("sumByColumn",function(){return function(e,t){var n=0;return e.forEach(function(e){n+=parseInt(e[t])}),n}}),app.filter("formatTime",function(){return function(e,t){m=e%60,h=(e-m)/60;h.toString(),m,m.toString();return t||"h:mm"}}),app.filter("timeconvertin",function(){return function(e){return Number(e),m=e%60,h=(e-m)/60,tt="AM",h>11&&(tt="PM",h>12&&(h%=12)),(h<10?"0":"")+h.toString()+":"+(m<10?"0":"")+m.toString()+" "+tt}}),app.filter("stringnumber",function(){return function(e){return Number(e)}}),app.filter("toWords",function(){return function(e){var t=["","Thousand","Million","Billion","Trillion"],n=["Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],o=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],i=["Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(e=e.toString(),(e=e.replace(/[\, ]/g,""))!=parseFloat(e))return"not a number";var r=e.indexOf(".");if(-1==r&&(r=e.length),r>9)return"too big";for(var a=e.split(""),s="",c=0,l=0;l<r;l++)(r-l)%3==2?"1"==a[l]?(s+=o[Number(a[l+1])]+" ",l++,c=1):0!=a[l]&&(s+=i[a[l]-2]+" ",c=1):0!=a[l]&&(s+=n[a[l]]+" ",(r-l)%3==0&&(s+="hundred "),c=1),(r-l)%3==1&&(c&&(s+=t[(r-l-1)/3]+" "),c=0);if(r!=e.length){var u=e.length;s+="point ";for(l=r+1;l<u;l++)s+=n[a[l]]+" "}return s.replace(/\s+/g," ")}}),app.factory("Data",function(){return{get:function(e){return e.data},filterTask:function(e){},fmDate:function(e){var t=new Date;t.setDate(t.getDate()+Number(e));var n=("0"+(t.getMonth()+1)).slice(-2),o=("0"+t.getDate()).slice(-2);return[t.getFullYear(),n,o].join("-")},emObj:function(e){angular.forEach(e,function(e,t){e=e})}}}),app.factory("genPDF",function(){return{download:function(e,t){pdfMake.createPdf(e).download(t+".pdf")},open:function(e){pdfMake.createPdf(e).open()},print:function(e){pdfMake.createPdf(e).print()}}}),app.factory("Excel",["$window",function(e){var t=function(t){return e.btoa(unescape(encodeURIComponent(t)))},n=function(e,t){return e.replace(/{(\w+)}/g,function(e,n){return t[n]})};return{tableToExcel:function(e,o){var i={worksheet:o,table:$(e).html()};return"data:application/vnd.ms-excel;base64,"+t(n('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>',i))}}}]),app.factory("notify",function(){var e={title:"Are you sure?",text:"Do You Want To Delete This?",type:"warning"};return{notifyInit:function(){toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"}},success:function(){return this.notifyInit(),toastr.success("Successfully Created!","Success!")},error:function(){return this.notifyInit(),toastr.error("An Error Occurred!","Error!")},info:function(e,t){return this.notifyInit(),toastr.error(e,t)},warning:function(e,t){return this.notifyInit(),toastr.error(e,t)},custom:function(e,t,n){return this.notifyInit(),toastr[e](t,n)},alert:function(e,t,n){swal(e,t,n)},confirm:function(){swal({title:e.title,text:e.text,type:e.type,showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1,showLoaderOnConfirm:!0},function(e){swal("Deleted!","Branch Successfully Deleted","success")})}}}),app.factory("timefactory",function(){return{timein:function(e){return m=e%60,h=(e-m)/60,new Date(99,1,1,h,m,0,0)}}}),app.factory("AccessFactory",function(e){return{Perission:function(t){return e.get("static/rolemodule/"+t)}}}),function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var o=function(e){return e&&e.__esModule?e:{default:e}}(n(1));angular.module("angularjs-dropdown-multiselect",[]).directive("dmDropdownStaticInclude",["$compile",function(e){"ngInject";return function(t,n,o){var i=o.dmDropdownStaticInclude,r=n.html(i).contents();e(r)(t)}}]).directive("ngDropdownMultiselect",o.default)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{restrict:"AE",scope:{selectedModel:"=",options:"=",extraSettings:"=",events:"=",searchFilter:"=?",translationTexts:"=",disabled:"="},transclude:{toggleDropdown:"?toggleDropdown"},controller:o.default,templateUrl:"app/component/angularjs-dropdown-multiselect.html"}};var o=function(e){return e&&e.__esModule?e:{default:e}}(n(2))},function(e,t){"use strict";function n(e,t){var n=!1;return e.some(function(e){return e===t&&(n=!0,!0)}),n}function o(e,t,n){var o=-1;return e.some(function(e,i){return e[n]===t[n]&&(o=i,!0)}),o}function i(e,t,i,r){"ngInject";function a(){setTimeout(function(){var e=angular.element(t)[0].querySelector(".option");angular.isDefined(e)&&null!=e&&e.focus()},0)}function s(e){var n=t.find("button"),o=document.createElement("canvas").getContext("2d");return o.font=n.css("font-size")+n.css("font-family"),o.originalFont=n.css("font-size")+n.css("font-family"),o.fillStyle="#000000",o.measureText(e).width}var c=t.children()[0],l={onItemSelect:angular.noop,onItemDeselect:angular.noop,onSelectAll:angular.noop,onDeselectAll:angular.noop,onInitDone:angular.noop,onMaxSelectionReached:angular.noop,onSelectionChanged:angular.noop,onClose:angular.noop},u={dynamicTitle:!0,scrollable:!1,scrollableHeight:"300px",closeOnBlur:!0,displayProp:"label",enableSearch:!1,clearSearchOnClose:!1,selectionLimit:0,showCheckAll:!0,showUncheckAll:!0,showEnableSearchButton:!1,closeOnSelect:!1,buttonClasses:"btn btn-default",closeOnDeselect:!1,groupBy:void 0,checkBoxes:!1,groupByTextProvider:null,smartButtonMaxItems:0,smartButtonTextConverter:angular.noop,styleActive:!1,selectedToTop:!1,keyboardControls:!1,template:"{{getPropertyForObject(option, settings.displayProp)}}",searchField:"$",showAllSelectedText:!1},m={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"checked",selectionOf:"/",searchPlaceholder:"Search...",buttonDefaultText:"Select",dynamicButtonTextSuffix:"checked",disableSearch:"Disable search",enableSearch:"Enable search",selectGroup:"Select all:",allSelectedText:"All"},d={};angular.extend(u,e.extraSettings||[]),angular.extend(l,e.events||[]),angular.extend(m,e.translationTexts),u.closeOnBlur&&r.on("click",function(t){if(e.open){for(var o=t.target.parentElement,i=!1;angular.isDefined(o)&&null!==o&&!i;)o.className.split&&n(o.className.split(" "),"multiselect-parent")&&!i&&o===c&&(i=!0),o=o.parentElement;i||e.$apply(function(){e.close()})}}),angular.extend(e,{toggleDropdown:function(){e.open?e.close():e.open=!0,e.settings.keyboardControls&&e.open&&(1===e.settings.selectionLimit&&e.settings.enableSearch?setTimeout(function(){angular.element(t)[0].querySelector(".searchField").focus()},0):a()),e.settings.enableSearch&&e.open&&setTimeout(function(){angular.element(t)[0].querySelector(".searchField").focus()},0)},checkboxClick:function(t,n){e.setSelectedItem(n,!1,!0),t.stopImmediatePropagation()},externalEvents:l,settings:u,texts:m,input:d,close:function(){e.open=!1,e.input.searchFilter=e.settings.clearSearchOnClose?"":e.input.searchFilter,e.externalEvents.onClose()},selectCurrentGroup:function(t){e.selectedModel.splice(0,e.selectedModel.length),e.options.forEach(function(n){n[e.settings.groupBy]===t&&e.setSelectedItem(n,!1,!1)}),e.externalEvents.onSelectionChanged()},getGroupLabel:function(t){return null!==e.settings.groupByTextProvider?e.settings.groupByTextProvider(t):t},getButtonText:function(){if(e.settings.dynamicTitle&&e.selectedModel&&e.selectedModel.length>0){if(angular.isFunction(e.settings.smartButtonTextProvider))return e.settings.smartButtonTextProvider(e.selectedModel);if(e.settings.smartButtonMaxItems>0){var n=t[0].offsetWidth-24-2-8,o=[];angular.forEach(e.options,function(t){if(e.isChecked(t)){var n=e.getPropertyForObject(t,e.settings.displayProp),i=e.settings.smartButtonTextConverter(n,t);o.push(i||n)}}),e.selectedModel.length>e.settings.smartButtonMaxItems&&(o=o.slice(0,e.settings.smartButtonMaxItems)).push("...");var i=o.join(", "),r=i.length-4;if(0===t[0].offsetWidth)return i;if(n<=s("..."))return"...";for(;s(i)>n;)"..."!==o[o.length-1]&&(o.push("..."),r=(i+="...").length-4),i=i.slice(0,r)+i.slice(r+1),r-=1;return i}var a=angular.isDefined(e.selectedModel)?e.selectedModel.length:0;return 0===a?e.texts.buttonDefaultText:e.settings.showAllSelectedText&&a===e.options.length?e.texts.allSelectedText:a+" "+e.texts.dynamicButtonTextSuffix}return e.texts.buttonDefaultText},getPropertyForObject:function(e,t){if(angular.isDefined(e)&&Object.prototype.hasOwnProperty.call(e,t))return e[t]},selectAll:function(){e.deselectAll(!0),e.externalEvents.onSelectAll();var t=i("filter")(e.options,e.getFilter(e.input.searchFilter));angular.forEach(t,function(t){e.setSelectedItem(t,!0,!1)}),e.externalEvents.onSelectionChanged(),e.selectedGroup=null},deselectAll:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t||e.externalEvents.onDeselectAll(),e.selectedModel.splice(0,e.selectedModel.length),t||e.externalEvents.onSelectionChanged(),e.selectedGroup=null},setSelectedItem:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments[2],r=void 0,a=void 0;angular.isDefined(u.idProperty)?(r=-1!==o(e.selectedModel,t,u.idProperty),a=o(e.selectedModel,t,u.idProperty)):(r=-1!==e.selectedModel.indexOf(t),a=e.selectedModel.indexOf(t)),!n&&r?(e.selectedModel.splice(a,1),e.externalEvents.onItemDeselect(t),e.settings.closeOnDeselect&&e.close()):!r&&(0===e.settings.selectionLimit||e.selectedModel.length<e.settings.selectionLimit)?(e.selectedModel.push(t),i&&e.externalEvents.onItemSelect(t),e.settings.closeOnSelect&&e.close(),e.settings.selectionLimit>0&&e.selectedModel.length===e.settings.selectionLimit&&e.externalEvents.onMaxSelectionReached()):1!==e.settings.selectionLimit||r||e.selectedModel.length!==e.settings.selectionLimit||(e.selectedModel.splice(0,1),e.selectedModel.push(t),i&&e.externalEvents.onItemSelect(t),e.settings.closeOnSelect&&e.close()),i&&e.externalEvents.onSelectionChanged(),e.selectedGroup=null},isChecked:function(t){return angular.isDefined(u.idProperty)?-1!==o(e.selectedModel,t,u.idProperty):-1!==e.selectedModel.indexOf(t)},keyDownLink:function(t){var n=angular.element(t.target).scope(),o=void 0,i=t.target.parentNode;if(e.settings.keyboardControls)if(13===t.keyCode||32===t.keyCode)t.preventDefault(),n.option?e.setSelectedItem(n.option,!1,!0):"deselectAll"===t.target.id?e.deselectAll():"selectAll"===t.target.id&&e.selectAll();else if(38===t.keyCode){for(t.preventDefault(),i.previousElementSibling&&(o=i.previousElementSibling.querySelector("a")||i.previousElementSibling.querySelector("input"));!o&&i;)(i=i.previousElementSibling)&&(o=i.querySelector("a")||i.querySelector("input"));o&&o.focus()}else if(40===t.keyCode){for(t.preventDefault(),i.nextElementSibling&&(o=i.nextElementSibling.querySelector("a")||i.nextElementSibling.querySelector("input"));!o&&i;)(i=i.nextElementSibling)&&(o=i.querySelector("a")||i.querySelector("input"));o&&o.focus()}else 27===t.keyCode&&(t.preventDefault(),e.toggleDropdown())},keyDownSearchDefault:function(t){var n=t.target.parentNode.parentNode,o=void 0;if(e.settings.keyboardControls)if(9===t.keyCode||40===t.keyCode)t.preventDefault(),a();else if(38===t.keyCode){for(t.preventDefault(),n.previousElementSibling&&(o=n.previousElementSibling.querySelector("a")||n.previousElementSibling.querySelector("input"));!o&&n;)(n=n.previousElementSibling)&&(o=n.querySelector("a")||n.querySelector("input"));o&&o.focus()}else 27===t.keyCode&&(t.preventDefault(),e.toggleDropdown())},keyDownSearch:function(t,n){var o=void 0;e.settings.keyboardControls&&13===t.keyCode&&(1===e.settings.selectionLimit&&e.settings.enableSearch?1===(o=i("filter")(e.options,e.getFilter(n))).length&&e.setSelectedItem(o[0],!1,!0):e.settings.enableSearch&&e.selectAll())},getFilter:function(t){var n={};return n[e.settings.searchField]=t,n},toggleSearch:function(t){t&&t.stopPropagation(),e.settings.enableSearch=!e.settings.enableSearch,e.settings.enableSearch||(e.input.searchFilter="")},keyDownToggleSearch:function(){e.settings.keyboardControls&&13===event.keyCode&&(e.toggleSearch(),e.settings.enableSearch?setTimeout(function(){angular.element(t)[0].querySelector(".searchField").focus()},0):a())},orderFunction:function(t,n){if(angular.isUndefined(n))return-1;if(angular.isUndefined(t))return 1;if("object"!==t.type||"object"!==n.type)return t.index<n.index?-1:1;var o=t.value,i=n.value;return e.settings.groupBy&&o[e.settings.groupBy]!==i[e.settings.groupBy]?o[e.settings.groupBy]<i[e.settings.groupBy]?1:-1:e.settings.selectedToTop?!e.isChecked(o)&&!e.isChecked(i)||e.isChecked(o)&&e.isChecked(i)?e.options.indexOf(o)<e.options.indexOf(i)?-1:1:e.isChecked(o)?-1:1:e.options.indexOf(o)<e.options.indexOf(i)?-1:1}}),e.externalEvents.onInitDone()}i.$inject=["$scope","$element","$filter","$document"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=i}]),angular.module("angularjs-dropdown-multiselect").run(["$templateCache",function(e){e.put("app/component/angularjs-dropdown-multiselect.html",'<div class="multiselect-parent btn-group dropdown-multiselect" ng-class="{open: open}"><div ng-transclude=toggleDropdown ng-click=toggleDropdown()><button ng-disabled=disabled type=button class=dropdown-toggle ng-class=settings.buttonClasses>{{getButtonText()}}&nbsp;<span class=caret></span></button></div><ul class="dropdown-menu dropdown-menu-form" ng-if=open ng-style="{display: open ? \'block\' : \'none\', height : settings.scrollable ? settings.scrollableHeight : \'auto\', overflow: \'auto\' }"><li ng-if="settings.showCheckAll && settings.selectionLimit === 0"><a ng-keydown=keyDownLink($event) data-ng-click=selectAll() tabindex=-1 id=selectAll><span class="glyphicon glyphicon-ok"></span> {{texts.checkAll}}</a></li><li ng-if=settings.showUncheckAll><a ng-keydown=keyDownLink($event) data-ng-click=deselectAll(); tabindex=-1 id=deselectAll><span class="glyphicon glyphicon-remove"></span> {{texts.uncheckAll}}</a></li><li ng-if="settings.selectByGroups && ((settings.showCheckAll && settings.selectionLimit > 0) || settings.showUncheckAll)" class=divider></li><li ng-repeat="currentGroup in settings.selectByGroups track by $index" ng-click=selectCurrentGroup(currentGroup)><a ng-class="{\'dropdown-selected-group\': selectedGroup === currentGroup}" tabindex=-1>{{::texts.selectGroup}} {{::getGroupLabel(currentGroup)}}</a></li><li ng-if="settings.selectByGroups && settings.showEnableSearchButton" class=divider></li><li ng-if="settings.showEnableSearchButton && settings.enableSearch"><a ng-keydown="keyDownLink($event); keyDownToggleSearch();" ng-click=toggleSearch($event); tabindex=-1>{{texts.disableSearch}}</a></li><li ng-if="settings.showEnableSearchButton && !settings.enableSearch"><a ng-keydown="keyDownLink($event); keyDownToggleSearch();" ng-click=toggleSearch($event); tabindex=-1>{{texts.enableSearch}}</a></li><li ng-if="(settings.showCheckAll && settings.selectionLimit > 0) || settings.showUncheckAll || settings.showEnableSearchButton" class=divider></li><li ng-if=settings.enableSearch class=divider></li><li ng-if=settings.groupBy ng-repeat-start="option in orderedItems = ( options | filter:getFilter(input.searchFilter) | orderBy:\'\':false:orderFunction)" ng-show="getPropertyForObject(option, settings.groupBy) !== getPropertyForObject(orderedItems[$index - 1], settings.groupBy)" role=presentation class=dropdown-header>{{ getGroupLabel(getPropertyForObject(option, settings.groupBy)) }}</li><li ng-if=settings.groupBy ng-class="{\'active\': isChecked(option) && settings.styleActive}" ng-repeat-end role=presentation><a ng-keydown="option.disabled || keyDownLink($event)" role=menuitem class=option tabindex=-1 ng-click="option.disabled || setSelectedItem(option, false, true)" ng-disabled=option.disabled><div ng-if=settings.checkBoxes class=checkbox><label><input class=checkboxInput type=checkbox ng-click="checkboxClick($event, option)" ng-checked=isChecked(option)> <span dm-dropdown-static-include={{settings.template}}></span></label></div><span ng-if=!settings.checkBoxes data-ng-class="{\'glyphicon glyphicon-ok\': isChecked(option)}"></span> <span dm-dropdown-static-include={{settings.template}}></span></a></li><li ng-if=!settings.groupBy ng-class="{\'active\': isChecked(option) && settings.styleActive}" role=presentation ng-repeat="option in options | filter:getFilter(input.searchFilter) | orderBy:\'\':false:orderFunction"><a ng-keydown="option.disabled || keyDownLink($event)" role=menuitem class=option tabindex=-1 ng-click="option.disabled || setSelectedItem(option, false, true)" ng-disabled=option.disabled><div ng-if=settings.checkBoxes class=checkbox><label><input class=checkboxInput type=checkbox ng-click="checkboxClick($event, option)" ng-checked=isChecked(option)> <span dm-dropdown-static-include={{settings.template}}></span></label></div><span ng-if=!settings.checkBoxes data-ng-class="{\'glyphicon glyphicon-ok\': isChecked(option)}"></span> <span ng-if=!settings.checkBoxes dm-dropdown-static-include={{settings.template}}></span></a></li><li class=divider ng-show="settings.selectionLimit > 1"></li><li role=presentation ng-show="settings.selectionLimit > 1"><a role=menuitem>{{selectedModel.length}} {{texts.selectionOf}} {{settings.selectionLimit}} {{texts.selectionCount}} </a></li></ul></div>')}]),app.controller("dashboardCtrl",["$scope","$rootScope","$http","$log","Dashboard","Data","notify","cfpLoadingBar","$window",function(e,t,n,o,i,r,a,s,c){e.singleBarLabels=[],e.singleBarData=[],i.get().then(function(t){var n=[];angular.forEach(r.get(t),function(t){n.push(Number(t.total)),e.singleBarLabels.push(t.service)}),e.singleBarData.push(n)},function(e){}),e.singleBarSeries=["Total Jobs"],e.singleBarOverride=[{label:"Total Jobs",backgroundColor:"rgba(98,203,49,0.5)",borderColor:"rgba(98,203,49,0.8)",highlightFill:"rgba(98,203,49,0.75)",highlightStroke:"rgba(98,203,49,1)",borderWidth:1,responsive:!0,scaleBeginAtZero:!0}],i.getReminders().then(function(t){e.nextWeekReminders=r.get(t)},function(e){}),i.getToScheduleJobs().then(function(t){e.toScheduleJobs=r.get(t)},function(e){}),i.getHeaderAlerts().then(function(t){e.headerAlerts=r.get(t)},function(e){}),i.getAlerts().then(function(t){e.notifications=r.get(t)},function(e){}),e.markReminderNiotified=function(t){i.reminderNotified(t).then(function(t){i.getHeaderAlerts().then(function(t){e.headerAlerts=r.get(t)},function(e){})},function(e){})},e.markTaskNotified=function(t){i.taskNotified(t).then(function(t){i.getHeaderAlerts().then(function(t){e.headerAlerts=r.get(t)},function(e){})},function(e){})},i.getTaskgroupDropDown().then(function(t){e.taskGroup=r.get(t),s.complete()},function(e){s.complete()}),e.getTaskNotificationDetail=function(t){s.start(),i.taskDetail(t).then(function(t){e.taskForm=r.get(t),$("#newTask").modal("toggle"),s.complete()},function(e){s.complete()})},e.getRminderNotificationDetail=function(t){s.start(),i.reminderDetail(t).then(function(t){e.formData=r.get(t),$("#remindModel").modal("toggle"),s.complete()},function(e){s.complete()})},e.logoutApp=function(){s.start(),n.post("/logout").then(function(e){s.complete(),c.location.reload()},function(e){c.location.reload()})}}]),app.factory("Dashboard",["$http",function(e){return{get:function(){return e.get("sim/pm/job/todayjobs")},getReminders:function(){return e.get("sim/sut/reminder/nextweek")},getHeaderAlerts:function(){return e.get("sim/sap/notification/headalerts")},getAlerts:function(){return e.get("sim/sap/notification/alerts")},taskDetail:function(t){return e.get("sim/pm/task/"+t)},reminderDetail:function(t){return e.get("sim/sut/reminder/"+t)},reminderNotified:function(t){return e.post("sim/sut/reminder/notified/"+t)},taskNotified:function(t){return e.post("sim/pm/task/notified/"+t)},getTaskgroupDropDown:function(){return e.get("sim/pm/taskgroup")},getToScheduleJobs:function(){return e.post("sim/pm/job/unscheduled")}}}]),app.controller("branchCtrl",["$scope","$http","$log","Branch","Data","notify","cfpLoadingBar","$timeout","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c,l){e.formData={hbbranchid:0,departments:[]},o.Departments().then(function(t){e.departments=i.get(t)},function(e){}),o.DropDown().then(function(t){e.managers=i.get(t)},function(e){}),a.start(),o.get().then(function(t){e.branches=i.get(t),e.doPagination(e.branches),a.complete()},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.clearForm=function(){$(".departs").prop("checked",!1),e.formData={hbbranchid:0,departments:[]}},e.submitBranch=function(){a.start(),o.save(e.formData).then(function(t){i.get(t).success?(e.formData={hbbranchid:0,departments:[]},$(".departs").prop("checked",!1),a.complete(),$("#myModal").modal("hide"),r.custom("success","Branch Successfully Saved!","Branch"),o.get().then(function(t){e.branches=i.get(t),e.doPagination(e.branches)},function(e){})):(a.complete(),"UQ_BranchCode"==i.get(t).message?r.custom("error","Branch Code Already Exists!","Branch"):r.custom("error","Something went wrong!","Branch"))},function(e){r.custom("error","Something went wrong!","Branch"),a.complete()})},e.editRow=function(t){a.start(),o.show(t).then(function(t){e.formData=i.get(t),angular.forEach(e.formData.departments,function(e){angular.element(document).ready(function(){$("input:checkbox[value="+e.hbddepartmentid+"]").prop("checked",!0)})}),a.complete(),$("#myModal").modal("show")},function(e){a.complete()})},e.deleteBranch=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Branch?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","Branch Successfully Deleted","success"),o.get().then(function(t){e.branches=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},angular.element(document).ready(function(){$(document).on("change",".departs",function(){if(this.checked)e.formData.hbbranchid,e.formData.departments.push({hbdbranchdepartmentid:"0",hbdbranchid:e.formData.hbbranchid,hbddepartmentid:$(this).data("id")});else for(var t=0;t<e.formData.departments.length;t++)e.formData.departments[t].hbddepartmentid==$(this).data("id")&&e.formData.departments.splice(t,1)}),$("#btnExport").click(function(e){e.preventDefault();var t=document.getElementById("table_wrapper").outerHTML.replace(/ /g,"%20"),n=document.createElement("table");n.href="data:application/vnd.ms-excel, "+t,n.download="exported_table_"+Math.floor(9999999*Math.random()+1e6)+".xls",n.click()})})}]),app.factory("Branch",["$http",function(e){return{get:function(){return e.get("sim/hm/branch")},show:function(t){return e.get("sim/hm/branch/"+t)},save:function(t){return e({method:"POST",url:"sim/hm/branch",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},destroy:function(t){return e({method:"POST",url:"sim/hm/branch/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},test:function(e){return e},DropDown:function(){return e.get("sim/hm/employee/ddmenu")},Departments:function(){return e.get("sim/hm/department/ddmenu")}}}]),app.controller("profileCtrl",["$scope","$http","$log","Profile","Data","notify","cfpLoadingBar",function(e,t,n,o,i,r,a){e.formData={},a.start(),o.get().then(function(t){a.complete(),$("#myModal").modal("show"),e.formData=i.get(t)},function(e){a.complete()}),o.getCountry().then(function(t){e.countries=i.get(t)},function(e){}),o.getTimezone().then(function(t){e.timezones=i.get(t)},function(e){}),o.getCurrency().then(function(t){e.currencies=i.get(t)},function(e){}),e.data=function(e){alert(e)},e.saveProfile=function(){a.start(),o.save(e.formData).then(function(t){a.complete(),r.custom("success"," Profile Successfully Saved!","Profile"),o.get().then(function(t){e.formData=t.data},function(e){r.custom("error","Something went wrong!","Profile")})},function(e){a.complete(),r.custom("error","Something went wrong!","Profile")})}}]),app.factory("Profile",["$http",function(e){return{get:function(){return e.get("M@ster786/tenant/company/get")},getCountry:function(){return e.get("M@ster786/ddmenu/am/country")},getTimezone:function(){return e.get("M@ster786/ddmenu/am/timezone")},getCurrency:function(){return e.get("M@ster786/ddmenu/am/currency")},save:function(t){return e({method:"POST",url:"M@ster786/tenant/company/post",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})}}}]),app.controller("departmentCtrl",["$scope","$http","$log","Department","Data","notify","cfpLoadingBar","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c){e.formData={hddepartmentid:0},o.DropDown().then(function(t){e.heads=i.get(t)},function(e){}),a.start(),o.get().then(function(t){a.complete(),e.departments=i.get(t),e.doPagination(e.departments)},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.clearForm=function(){e.formData={hddepartmentid:0}},e.submitDepartment=function(){a.start(),o.save(e.formData).then(function(t){i.get(t).success?(e.formData={hddepartmentid:0},a.complete(),$("#myModal").modal("hide"),r.custom("success","Department Successfully Saved!","Department"),o.get().then(function(t){e.departments=i.get(t),e.doPagination(e.departments)},function(e){n.info(e)})):(a.complete(),"UQ_DepartmentCode"==i.get(t).message?r.custom("error","Department Code  Already Exists!","Department"):r.custom("error","Something went wrong!","Department"))},function(e){a.complete(),r.custom("error","Something went wrong!","Department")})},e.editRow=function(t){a.start(),o.show(t).then(function(t){e.formData=i.get(t),a.complete(),$("#myModal").modal("show")},function(e){})},e.deleteDepartment=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Department?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","Department Successfully Deleted","success"),o.get().then(function(t){e.departments=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})}}]),app.factory("Department",["$http",function(e){return{get:function(){return e.get("sim/hm/department")},show:function(t){return e.get("sim/hm/department/"+t)},save:function(t){return e({method:"POST",url:"sim/hm/department",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},destroy:function(t){return e({method:"POST",url:"sim/hm/department/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},DropDown:function(){return e.get("sim/hm/employee/ddmenu")}}}]),app.controller("designationCtrl",["$scope","$http","$log","Designation","Data","notify","cfpLoadingBar","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c){e.formData={hdgdesignationid:0},o.DropDown().then(function(t){e.managers=i.get(t)},function(e){}),a.start(),o.get().then(function(t){a.complete(),e.designations=i.get(t),e.doPagination(e.designations)},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.clearForm=function(){e.formData={hdgdesignationid:0}},e.submitDesignation=function(){a.start(),o.save(e.formData).then(function(t){i.get(t).success?(e.formData={hdgdesignationid:0},$("#myModal").modal("hide"),a.complete(),r.custom("success","Designation Successfully Saved!","Designation"),o.get().then(function(t){e.designations=i.get(t),e.doPagination(e.designations)},function(e){n.info(e)})):(a.complete(),"UQ_DesignationCode"==i.get(t).message?r.custom("error","Designation Code Already Exists!","Designation"):r.custom("error","Something went wrong!","Designation"))},function(e){a.complete(),r.custom("error","Something went wrong!","Designation")})},e.editRow=function(t){a.start(),o.show(t).then(function(t){e.formData=i.get(t),a.complete(),$("#myModal").modal("show")},function(e){})},e.deleteDesignation=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Designation?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","Designation Successfully Deleted","success"),o.get().then(function(t){e.designations=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})}}]),app.factory("Designation",["$http",function(e){return{get:function(){return e.get("sim/hm/designation")},show:function(t){return e.get("sim/hm/designation/"+t)},save:function(t){return e({method:"POST",url:"sim/hm/designation",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},destroy:function(t){return e({method:"POST",url:"sim/hm/designation/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},DropDown:function(){return e.get("sim/hm/employee/ddmenu")}}}]),app.controller("employeeCtrl",["$scope","$http","$log","Employee","Data","notify","cfpLoadingBar","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c){e.formData={heemployeeid:0};angular.element(document.querySelector("script"));o.DropDown("branch").then(function(t){e.branches=i.get(t)},function(e){}),o.employees().then(function(t){e.supervisors=i.get(t)},function(e){}),o.DropDown("department").then(function(t){e.departments=i.get(t)},function(e){}),o.DropDown("designation").then(function(t){e.designations=i.get(t)},function(e){}),o.country().then(function(t){e.countries=i.get(t)},function(e){}),a.start(),o.get().then(function(t){a.complete(),e.employees=i.get(t),e.doPagination(e.employees)},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.sameas,e.sameAs=function(t,n){e.formData.heresidentialaddress=1==n?t:" "},e.clearForm=function(){e.addtocntact=!0,e.formData={heemployeeid:0}},e.submitEmployee=function(){a.start(),o.save(e.formData).then(function(t){i.get(t).success?(e.formData={heemployeeid:0},a.complete(),$("#myModal").modal("hide"),r.custom("success","Employee Successfully Saved","Employee"),o.get().then(function(t){e.employees=i.get(t),e.doPagination(e.employees)},function(e){n.info(e)})):(a.complete(),"UQ_EmployeeCode"==i.get(t).message?r.custom("error","Employee Code Already Exists!","Employee"):r.custom("error","Something went wrong!","Employee"))},function(e){a.complete(),r.custom("error","Something went wrong!","Employee")})},e.editRow=function(t){e.addtocntact=!1,a.start(),o.show(t).then(function(t){e.formData=i.get(t),a.complete(),$("#myModal").modal("show")},function(e){})},e.deleteEmployee=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Employee?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","Employee Successfully Deleted","success"),o.get().then(function(t){e.employees=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},angular.element(document).ready(function(){$("#quantity").keypress(function(e){if(8!=e.which&&0!=e.which&&(e.which<48||e.which>57))return $("#errmsg").html("Digits Only").show().fadeOut("slow"),!1})})}]),app.factory("Employee",["$http",function(e){return{get:function(){return e.get("sim/hm/employee")},show:function(t){return e.get("sim/hm/employee/"+t)},save:function(t){return e({method:"POST",url:"sim/hm/employee",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},employees:function(){return e.get("sim/hm/employee/ddmenu")},destroy:function(t){return e({method:"POST",url:"sim/hm/employee/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},DropDown:function(t){return e.get("sim/hm/"+t+"/ddmenu")},country:function(){return e.get("M@ster786/ddmenu/am/country")}}}]),app.controller("expsheetCtrl",["$scope","$http","$log","expSheet","Data","notify","cfpLoadingBar","AccessFactory","$state","$filter",function(e,t,n,o,r,a,s,c,l,u){e.formData={pjejobexpenseid:0,details:[],jobs:[],escreferencetype:"Automatic",escexpensesheetconfigurationid:1},e.detailData={},e.searchData={},e.selectedJobs=[],e.editable=!1,e.filterData={pjeisactive:!0},e.getLocation=function(e){return t.get("sim/pm/expense/ddmenu",{}).then(function(e){return e.data.map(function(e){return e.pjetitle})})},o.getTitle().then(function(t){e.ddtitles=r.get(t)},function(e){}),s.start(),o.filterData(e.filterData).then(function(t){s.complete(),e.expsheets=r.get(t),e.doPagination(e.expsheets)},function(e){s.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.modelOptions={debounce:{default:100,blur:250},getterSetter:!0},o.customer().then(function(t){e.customers=r.get(t)},function(e){}),o.users().then(function(t){e.users=r.get(t)},function(e){}),o.service().then(function(t){e.services=r.get(t)},function(e){}),e.findJobs=function(){e.listJobs=[],o.findList(e.searchData).then(function(t){angular.forEach(r.get(t),function(t){var n=0;angular.forEach(e.formData.jobs,function(e){t.jjobid==e.jepjobid&&(n=1)}),0==n&&e.listJobs.push(t)})},function(e){})},e.searchList=function(){s.start(),o.filterData(e.filterData).then(function(t){s.complete(),e.expsheets=r.get(t)},function(e){s.complete()})},e.makeSelected=function(t,n){e.selectedJobs.push(t),e.formData.jobs.push({jepjobid:t.jjobid,jepjobexpenseid:e.formData.pjejobexpenseid}),e.listJobs.splice(n,1)},e.addDetail=function(){e.formData.details.push({esdjobexpenseid:e.formData.jepjobid,esddescription:e.detailData.desc,esdamount:e.detailData.amount,esdscanfilepath:e.detailData.fmpath}),e.detailData={}},e.removeDetail=function(t){e.formData.details.splice(t,1)},e.removeFromSelected=function(t){e.formData.jobs.splice(t,1),e.selectedJobs.splice(t,1)},e.saveExpense=function(){var t=0;for(i=0;i<e.formData.details.length;i++)t+=Number(e.formData.details[i].esdamount),e.formData.pjeamount=t;e.formData.details.length<1||e.formData.jobs.length<1?a.custom("error","Detail or Jobs are not Selected!","Details"):(s.start(),o.save(e.formData).then(function(t){r.get(t).success?(s.complete(),e.reset(),a.custom("success","ExpenseSheet Successfully Saved!"),$("#expenseSheet").modal("hide"),o.get().then(function(t){e.expsheets=r.get(t),e.doPagination(e.expsheets)},function(e){})):(s.complete(),"UQ_ExpenseSheetReference"==r.get(t).message?a.custom("error","ExpenseSheet Referencee Already Exists!","ExpenseSheet"):a.custom("error","Something went wrong!","ExpenseSheet"))},function(e){s.complete(),a.custom("error","Something went wrong!","ExpenseSheet")}))},e.clearForm=function(){e.selectedJobs=[],e.formData={pjejobexpenseid:0,details:[],jobs:[]},o.dfConfig().then(function(t){e.formData.escexpensesheetconfigurationid=r.get(t).escexpensesheetconfigurationid,e.formData.escreferencetype=r.get(t).escreferencetype},function(e){})},e.reset=function(){e.selectedJobs=[],e.formData={pjejobexpenseid:0,details:[],jobs:[]}},e.editRow=function(t){e.reset(),s.start(),o.show(t).then(function(n){s.complete(),$("#myModal").modal("show"),e.formData=r.get(n),o.details(t).then(function(t){e.formData.details=r.get(t)},function(e){})},function(e){s.complete()}),o.getChild("job",t,"expenseid").then(function(t){e.formData.jobs=[],angular.forEach(r.get(t),function(t){e.formData.jobs.push({jepjobid:t.jepjobid,jepjobexpenseid:t.jepjobexpenseid})}),e.selectedJobs=r.get(t)},function(e){})},e.deleteSheet=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This JobSheet?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy(t).then(function(t){swal("Deleted!","ExpenseSheet Successfully Deleted","success"),o.get().then(function(t){e.expsheets=r.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})}}]),app.factory("expSheet",["$http",function(e){return{get:function(){return e.get("sim/pm/expense")},show:function(t){return e.get("sim/pm/expense/"+t)},save:function(t){return e({method:"POST",url:"sim/pm/expense",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},filterData:function(t){return e({method:"POST",url:"sim/pm/expense/findlist",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},details:function(t){return e.get("sim/pm/expense/detail/"+t)},getChild:function(t,n,o){return e.get("sim/pm/expense/pivot/"+t+"/"+n+"/"+o)},destroy:function(t){return e({method:"POST",url:"sim/pm/expense/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},users:function(){return e.get("sim/sap/user/ddmenu")},employee:function(){return e.get("sim/hr/employee/ddmenu")},service:function(){return e.get("sim/sm/service/ddmenu")},customer:function(){return e.get("sim/sm/customer/ddmenu")},findList:function(t){return e({method:"POST",url:"sim/pm/job/findlist",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},searchTitle:function(t){return e.get("sim/hm/designation/ddmenu")},dfConfig:function(){return e.get("sim/pms/config/expensesheet/list")},getTitle:function(){return e.get("sim/pm/expense/ddmenu")}}}]),app.controller("jobsCtrl",["$scope","$http","$log","$timeout","Jobs","Data","notify","Excel","cfpLoadingBar","AccessFactory","$state","$rootScope",function(e,t,n,o,i,r,a,s,c,l,u,m){e.viewData={},m.filterData={jstatusid:24},1==m.statusvalue&&(m.filterData.jstatusid=22),c.start(),i.findList(m.filterData).then(function(t){c.complete(),e.jobs=r.get(t),e.doPagination(e.jobs)},function(e){c.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},i.customer().then(function(t){e.customers=r.get(t)},function(e){}),i.jobsites().then(function(t){e.jobsites=r.get(t)},function(e){}),i.branches().then(function(t){e.branches=r.get(t)},function(e){}),i.service().then(function(t){e.services=r.get(t)},function(e){}),i.status().then(function(t){e.status=r.get(t)},function(e){}),e.searchList=function(){i.findList(m.filterData).then(function(t){e.jobs=r.get(t)},function(e){})},e.clearForm=function(){e.viewData={}},e.resetButtons=function(){e.suspend=!1,e.finished=!1,e.skiped=!1,e.reopen=!1,e.revert=!1,e.resume=!1},e.saveJob=function(){i.save({jjobid:e.viewData.jjobid,jjobreference:e.viewData.jjobreference}).then(function(t){0==r.get(t).success&&"UQ_JobReference_notnull"==r.get(t).message?a.custom("error","JobReference Reference is Already Exists!","Job"):(a.custom("success","Job Successfully Updated!","Job"),i.findList(m.filterData).then(function(t){e.jobs=r.get(t),e.doPagination(e.jobs)},function(e){}))},function(e){a.custom("error","Error Occured While Saving!","Job")})},e.editRow=function(t){c.start(),e.resetButtons(),i.show(t).then(function(t){switch(c.complete(),e.viewData=r.get(t),e.viewData.jstatusid){case"22":e.suspend=!0,e.skiped=!0;break;case"24":e.suspend=!0,e.skiped=!0,e.finished=!0;break;case"26":e.reopen=!0;break;case"28":e.resume=!0;break;case"30":e.revert=!0;break;default:e.suspend=!1,e.finished=!1,e.skiped=!1,e.reopen=!1,e.revert=!1,e.resume=!1}},function(e){c.complete()})},e.jobFinished=function(t){i.finish(t).then(function(t){a.custom("success","Job Updated as Finished!","Job"),e.finished=!1,i.findList(m.filterData).then(function(t){e.jobs=r.get(t)},function(e){}),$("#jobModal").modal("toggle")},function(e){a.custom("error","Error Occured While Updating!","Job")})},e.suspendJob=function(t){$("#jobModal").modal("hide"),swal({title:"Reason!",text:"Write a Reason to Suspend:",type:"input",showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top",inputPlaceholder:"Write reason"},function(n){return!1===n?($("#jobModal").modal("toggle"),!1):""===n?(swal.showInputError("You need to write something!"),!1):void i.suspend(t,n).then(function(t){a.custom("success","Job Suspended","Job"),e.suspend=!1,swal("Nice!","You wrote: "+n,"success"),i.findList(m.filterData).then(function(t){e.jobs=r.get(t)},function(e){})},function(e){a.custom("error","Faild to Suspend The Job!","Job")})})},e.skipJob=function(t){$("#jobModal").modal("hide"),swal({title:"Skips!",text:"How Many Jobs Do You Want To Skip?:",type:"input",showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top",customClass:"mySwal",inputPlaceholder:"Eg:- 12"},function(n){return!1===n?($("#jobModal").modal("toggle"),!1):""===n?(swal.showInputError("You need to write something!"),!1):void(isNaN(n)?swal.showInputError("Must input numbers!"):i.skip(t,n).then(function(t){a.custom("success","Job Skipped","Job"),swal("Nice!",n+" Jobs Skipped!","success"),e.skiped=!1,i.findList(m.filterData).then(function(t){e.jobs=r.get(t)},function(e){})},function(e){a.custom("error","Faild to Skip The Job!","Job")}))})},e.revertJob=function(t){i.revert(t).then(function(t){a.custom("success","Job Reverted","Job"),e.revert=!1,i.findList(m.filterData).then(function(t){e.jobs=r.get(t)},function(e){}),$("#jobModal").modal("toggle")},function(e){a.custom("error","Faild to Revert The Job!","Job")})},e.resumeJob=function(t){i.resume(t).then(function(t){a.custom("success","Job Resume","Job"),e.resume=!1,i.findList(m.filterData).then(function(t){e.jobs=r.get(t)},function(e){}),$("#jobModal").modal("toggle")},function(e){a.custom("error","Faild to Resume The Job!","Job")})},e.reopenJob=function(t){i.reopen(t).then(function(t){a.custom("success","Job Reopen","Job"),e.reopen=!1,i.findList(m.filterData).then(function(t){e.jobs=r.get(t)},function(e){}),$("#jobModal").modal("toggle")},function(e){a.custom("error","Faild to Reopen The Job!","Job")})},e.exportToExcel=function(e){var t=s.tableToExcel(e,"sheet name");o(function(){location.href=t},100)}}]),app.factory("Jobs",["$http",function(e){return{get:function(){return e.get("sim/pm/job")},findList:function(t){return e({method:"POST",url:"sim/pm/job/findlist",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},default:function(t){return e.get("sim/pms/config/"+t+"/list")},show:function(t){return e.get("sim/pm/job/"+t)},save:function(t){return e({method:"POST",url:"sim/pm/job",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},status:function(){return e.get("sim/ddmenu/pm/status")},finish:function(t){return e.post("sim/pm/job/finish/"+t)},suspend:function(t,n){return e.post("sim/pm/job/suspended/"+t+"/"+n)},reopen:function(t){return e.post("sim/pm/job/reopen/"+t)},resume:function(t){return e.post("sim/pm/job/resume/"+t)},revert:function(t){return e.post("sim/pm/job/revert/"+t)},skip:function(t,n){return e.post("sim/pm/job/skip/"+t+"/"+n)},jobsites:function(){return e.get("sim/sm/jobsite/ddmenu")},branches:function(){return e.get("sim/hm/branch/ddmenu")},service:function(){return e.get("sim/sm/service/ddmenu")},customer:function(){return e.get("sim/sm/customer/ddmenu")}}}]),app.controller("scheduleCtrl",["$scope","$http","$log","$filter","Schedule","Data","notify","cfpLoadingBar","timefactory","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c,l,u){e.formData={jshjobscheduleid:0,employees:[],jobs:[]},e.searchData={jstatusid:"22"},e.addon={},e.selectedJobs=[],e.filterData={jshisactive:"1",jshstatusid:"52"},e.filterToSchedule={days:"33"},e.filterJob={job:{jstatusid:"24"}},i.jobsites().then(function(t){e.jobsites=r.get(t)},function(e){}),i.customer().then(function(t){e.customers=r.get(t)},function(e){}),i.branches().then(function(t){e.branches=r.get(t)},function(e){}),i.service().then(function(t){e.services=r.get(t)},function(e){}),s.start(),i.filterData(e.filterData).then(function(t){e.schedules=r.get(t),e.doPagination(e.schedules),s.complete()},function(e){s.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},i.employee().then(function(t){e.employees=r.get(t)},function(e){}),i.users().then(function(t){e.users=r.get(t)},function(e){}),e.find=function(){e.listJobs=[],i.findList(e.searchData).then(function(t){angular.forEach(r.get(t),function(t){var n=0;angular.forEach(e.formData.jobs,function(e){t.jjobid==e.jspjobid&&(n=1)}),0==n&&e.listJobs.push(t)})},function(e){})},e.searchList=function(){i.filterData(e.filterData).then(function(t){e.schedules=r.get(t)},function(e){})},e.makeSelected=function(t,n){e.formData.jobs.push({jspjobid:t.jjobid,jspjobscheduleid:e.formData.jshjobscheduleid}),e.selectedJobs.push(t),e.listJobs.splice(n,1)},e.removeFromSelected=function(t,n){e.formData.jobs.splice(n,1),e.selectedJobs.splice(n,1)},e.theTeam=[],e.emid=!1,e.samdata={},e.addTeam=function(t,n){console.log(t),console.log(n.heemployeeid),$("#ship option:selected").css("display","none"),null==t?(a.custom("error","Please Select an Employee","Employee"),e.emid=!0):(e.formData.employees.push({espemployeeid:t,espjobscheduleid:e.formData.jshjobscheduleid}),e.emid=!1)},e.removeTeam=function(t){console.log(t),console.log($("#test"+t));var n=t-1;e.formData.employees.splice(n,1),$("#test"+t).css("display","block")},e.reset=function(){e.formData={jshjobscheduleid:0,employees:[],jobs:[]},e.searchData={},e.addon={},e.selectedJobs=[]},e.clearForm=function(){$("#ship option").css("display","block"),e.formData={jshjobscheduleid:0,employees:[],jobs:[]},e.addon={},e.selectedJobs=[],e.samdata={},i.dfConfig().then(function(t){e.formData.scscheduleconfigurationid=r.get(t).scscheduleconfigurationid,e.formData.screferencetype=r.get(t).screferencetype},function(e){})},e.chane=function(t){"1"==t&&(e.formData.jshstatusid="54"),"0"==t&&(e.formData.jshstatusid="52")},e.saveSchedule=function(){if(null==e.formData.jshtimein)t=0;else{e.myDate=new Date(e.formData.jshtimein);var t=e.myDate.getMinutes();t+=60*(o=e.myDate.getHours())}if(null==e.formData.jshtimeout)n=t;else{e.myDate=new Date(e.formData.jshtimeout);var n=e.myDate.getMinutes(),o=e.myDate.getHours();n+=60*o}if(t>n)return a.custom("error","Enter Valid Time In and Out","Time"),!1;e.formData.jshtimeout=n,e.formData.jshtimein=t,e.formData.jobs.length<1?a.custom("error","Jobs Not Selected","Details"):(console.log(e.formData),i.save(e.formData).then(function(t){r.get(t).success?(e.clearForm(),$("#schedule").modal("hide"),a.custom("success","Schedule Successfully Saved!","Schedule"),i.filterData(e.filterData).then(function(t){e.schedules=r.get(t),e.doPagination(e.schedules)},function(e){})):"UQ_JobScheduleReference"==r.get(t).message?a.custom("error","JobSchedule Reference  Already Exists!","JobSchedule"):a.custom("error","Something went wrong!","JobSchedule")},function(e){a.custom("error","Error Found While Saving!")}))},e.editRow=function(t){console.log(t),e.clearForm(),s.start(),i.show(t).then(function(t){s.complete(),$("#myModal").modal("show"),e.formData=r.get(t);var n=c.timein(e.formData.jshtimein),o=c.timein(e.formData.jshtimeout);console.log("fhdhg"+e.formData.intime),e.formData={jshtimein:n,jshtimeout:o,jshcreatedon:e.formData.jshcreatedon,jshdate:e.formData.jshdate,jshdeletedon:e.formData.jshdeletedon,jshheademployeeid:e.formData.jshheademployeeid,jshisactive:e.formData.jshisactive,jshjobscheduleid:e.formData.jshjobscheduleid,jshmodifiedon:e.formData.jshmodifiedon,jshreferencetype:e.formData.jshreferencetype,jshremarks:e.formData.jshremarks,jshscheduleconfigurationid:e.formData.shscheduleconfigurationid,jshschedulereference:e.formData.jshschedulereference,jshstatusid:e.formData.jshstatusid," jshuid":e.formData.jshuid}},function(e){s.complete()}),i.getChild("job",t,"scheduleid").then(function(t){e.formData.jobs=[],$("#schedule").modal("show"),angular.forEach(r.get(t),function(t){e.formData.jobs.push({jspjobid:t.jspjobid,jspjobscheduleid:t.jspjobscheduleid})}),e.selectedJobs=r.get(t)},function(e){}),i.getChild("employee",t,"scheduleid").then(function(t){e.formData.employees=[],e.formData.employees=r.get(t),console.log(e.formData.employees),angular.forEach(e.formData.employees,function(e){$("#test"+e.espemployeeid).css("display","none")})},function(e){}),console.log(e.formData.employees),console.log(e.valdata)},e.deleteSchedule=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Quotation?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?i.destroy(t).then(function(t){$("#schedule").modal("hide"),swal("Deleted!","Schedule Successfully Deleted","success"),i.filterData(e.filterData).then(function(t){e.schedules=r.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},e.changetimein=function(t){e.formData.jshtimein=t},e.changetimeout=function(t){e.formData.jshtimeout=t},e.searchToSchedule=function(){i.filterToSchedule(e.filterToSchedule).then(function(t){e.toSchedules=r.get(t)},function(e){})},s.start(),i.filterToSchedule(e.filterToSchedule).then(function(t){e.toSchedules=r.get(t),s.complete()},function(e){s.complete()}),e.searchJob=function(){i.filterJob(e.filterJob).then(function(t){e.jobs=r.get(t)},function(e){})},s.start(),i.filterJob(e.filterJob).then(function(t){e.jobs=r.get(t),s.complete()},function(e){s.complete()})}]),app.factory("Schedule",["$http",function(e){return{get:function(){return e.get("sim/pm/schedule")},save:function(t){return e({method:"POST",url:"sim/pm/schedule",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},show:function(t){return e.get("sim/pm/schedule/"+t)},getChild:function(t,n,o){return e.get("sim/pm/schedule/pivot/"+t+"/"+n+"/"+o)},users:function(){return e.get("sim/sap/user/ddmenu")},destroy:function(t){return e({method:"POST",url:"sim/pm/schedule/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},jobsites:function(){return e.get("sim/sm/jobsite/ddmenu")},employee:function(){return e.get("sim/hm/employee/ddmenu")},customer:function(){return e.get("sim/sm/customer/ddmenu")},branches:function(){return e.get("sim/hm/branch/ddmenu")},service:function(){return e.get("sim/sm/service/ddmenu")},filterData:function(t){return e({method:"POST",url:"sim/pm/schedule/findlist",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},findList:function(t){return e({method:"POST",url:"sim/pm/job/findlist",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},dfConfig:function(){return e.get("sim/pms/config/schedule/list")},filterToSchedule:function(t){return e({method:"POST",url:"sim/pm/job/unscheduled",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},filterJob:function(t){return e({method:"POST",url:"sim/pm/schedule/jobs",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})}}}]),app.controller("jobsheetsCtrl",["$scope","$http","$log","Jobsheet","Data","notify","cfpLoadingBar","$rootScope","AccessFactory","$state","timefactory",function(e,t,n,o,i,r,a,s,c,l,u){e.formData={jstjobsheetid:0,employees:[],jobs:[]},e.searchData={},e.selectedJobs=[],e.teamData={},e.theTeam=[],e.editable=!1,e.filterData={jstisactive:45},o.customer().then(function(t){e.customers=i.get(t)},function(e){}),o.employee().then(function(t){e.employees=i.get(t)},function(e){}),o.users().then(function(t){e.users=i.get(t)},function(e){}),a.start(),o.filterData(e.filterData).then(function(t){a.complete(),e.jobsheets=i.get(t),e.doPagination(e.jobsheets)},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},o.service().then(function(t){e.services=i.get(t)},function(e){}),e.findJobs=function(){console.log(e.searchData),e.listJobs=[],o.findList(e.searchData).then(function(t){console.log(i.get(t)),angular.forEach(i.get(t),function(t){var n=0;angular.forEach(e.formData.jobs,function(e){t.jjobid==e.jtpjobid&&(n=1)}),0==n&&e.listJobs.push(t)})},function(e){}),console.log(e.listJobs)},e.makeSelected=function(t,n){e.selectedJobs.push(t),e.formData.jobs.push({jtpjobid:t.jjobid,jtpjobsheetid:e.formData.jstjobsheetid}),e.listJobs.splice(n,1)},e.removeFromSelected=function(t,n){e.formData.jobs.splice(n,1),e.selectedJobs.splice(n,1)},e.searchList=function(){o.filterData(e.filterData).then(function(t){e.jobsheets=i.get(t)},function(e){})},e.saveworktime=function(t){mout=t%60,hout=(t-mout)/60,e.outtime=(hout<10?"0":"")+hout.toString()+":"+(mout<10?"0":"")+mout.toString(),parseInt(e.outtime)},e.saveovertime=function(t){m=t%60,h=(t-m)/60;var n=(h<10?"0":"")+h.toString()+":"+(m<10?"0":"")+m.toString();e.teamData.ovrtm=n},e.req=!1,e.addTeam=function(t){console.log(e.teamData.ttworktm);e.teamData.ttworktm;""==e.teamData.employee||void 0==e.teamData.employee||null==e.teamData.employee?(e.req=!0,r.custom("error","Please Select an Employee","Employee")):(e.req=!1,e.formData.employees.push({ewhjobsheetid:e.formData.jstjobsheetid,ewhemployeeid:e.teamData.employee,ewhtotalminutes:e.teamData.ttworktm,ewhallowance:e.teamData.allws,ewhotinminutes:e.teamData.ovrtm}),e.teamData={})},e.removeDetail=function(t){e.formData.employees.splice(t,1)},e.clearForm=function(){e.selectedJobs=[],e.formData={jstjobsheetid:0,employees:[],jobs:[]},o.dfConfig().then(function(t){e.formData.jscjobsheetconfigurationid=i.get(t).jscjobsheetconfigurationid,e.formData.jscreferencetype=i.get(t).jscreferencetype},function(e){})},e.reset=function(){e.selectedJobs=[],e.formData={jstjobsheetid:0,employees:[],jobs:[]}},e.changeworktime=function(e){console.log(e)},e.saveSheet=function(){e.myDate=new Date(e.formData.jsttimein);var t=e.myDate.getMinutes(),n=e.myDate.getHours();t+=60*n,e.myDate=new Date(e.formData.jsttimeout);var a=e.myDate.getMinutes();if(n=e.myDate.getHours(),a+=60*n,t>a)return r.custom("error","Enter Valid Time In and Out","Time"),!1;e.formData.jsttimeout=a,e.formData.jsttimein=t,console.log(e.formData.jsttimein),e.formData.jobs.length<1||e.formData.employees.length<1?r.custom("error","Employees Or Jobs are not Selected","Job"):o.save(e.formData).then(function(t){i.get(t).success?(e.reset(),r.custom("success","Jobsheet Successfully Saved!","Jobsheet!"),o.get().then(function(t){e.jobsheets=i.get(t),e.doPagination(e.jobsheets)},function(e){}),$("#jobsheet").modal("hide")):"UQ_JobSheetReference"==i.get(t).message?r.custom("error","JobSheet Reference Already Exists!","JobSheet"):r.custom("error","Something went wrong!","JobSheet")},function(e){})},e.editRow=function(t){e.reset(),o.show(t).then(function(t){e.formData=i.get(t);var n=u.timein(e.formData.jsttimein),o=u.timein(e.formData.jsttimeout);e.formData.jsttimein=n,e.formData.jsttimeout=o,console.log(e.sheetintime)},function(e){}),o.details(t).then(function(t){e.formData.employees=i.get(t)},function(e){}),o.getChild("job",t,"sheetid").then(function(t){e.formData.jobs=[],angular.forEach(i.get(t),function(t){e.formData.jobs.push({jtpjobid:t.jtpjobid,jtpjobsheetid:t.jtpjobsheetid}),e.selectedJobs.push(t)})},function(e){})},e.deleteSheet=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This JobSheet?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy(t).then(function(t){swal("Deleted!","JobSheet Successfully Deleted","success"),o.get().then(function(t){e.jobsheets=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})}}]),app.factory("Jobsheet",["$http",function(e){return{get:function(){return e.get("sim/pm/sheet")},show:function(t){return e.get("sim/pm/sheet/"+t)},save:function(t){return e({method:"POST",url:"sim/pm/sheet",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},users:function(){return e.get("sim/sap/user/ddmenu")},filterData:function(t){return e({method:"POST",url:"sim/pm/sheet/findlist",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},destroy:function(t){return e({method:"POST",url:"sim/pm/sheet/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},details:function(t){return e.get("sim/pm/sheet/detail/"+t)},getChild:function(t,n,o){return e.get("sim/pm/sheet/pivot/"+t+"/"+n+"/"+o)},employee:function(){return e.get("sim/hm/employee/ddmenu")},service:function(){return e.get("sim/sm/service/ddmenu")},customer:function(){return e.get("sim/sm/customer/ddmenu")},findList:function(t){return e({method:"POST",url:"sim/pm/job/findlist",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},dfConfig:function(){return e.get("sim/pms/config/jobsheet/list")}}}]),app.controller("projectCtrl",["$scope","$http","$filter","Data","Project","notify","cfpLoadingBar","AccessFactory","genPDF","$state",function(e,t,n,o,i,r,a,s,c,l){e.editing=!1,e.detailsData={frequency:0,unit:0,rate:0},e.details=[],e.filterData={pstatusid:12},e.formData={pprojectid:0,pjobtypeid:1,details:[]},e.lpoData={pprojectid:0,pjobtypeid:2,details:[]},e.instantData={pprojectid:0,pjobtypeid:3,details:[]},i.CtTemplates().then(function(t){e.cttemplates=o.get(t)},function(e){}),i.customer().then(function(t){e.customers=o.get(t)},function(e){}),i.users().then(function(t){e.users=o.get(t)},function(e){}),i.status().then(function(t){e.status=o.get(t)},function(e){}),i.attentions().then(function(t){e.attentions=o.get(t)},function(e){}),i.jobsites().then(function(t){e.jobsites=o.get(t)},function(e){}),i.employees().then(function(t){e.employees=o.get(t)},function(e){}),i.branches().then(function(t){e.branches=o.get(t)},function(e){}),i.service().then(function(t){e.services=o.get(t)},function(e){}),a.start(),i.findlist(e.filterData).then(function(t){e.projects=o.get(t),e.doPagination(e.projects),a.complete()},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},i.jobtype().then(function(t){e.jobtype=o.get(t)},function(e){}),e.searchList=function(){a.start(),i.findlist(e.filterData).then(function(t){e.projects=o.get(t),a.complete()},function(e){})},e.sumFreq=function(t,n,o){e.detailsData.total=parseFloat(t)*parseFloat(n)*parseFloat(o)},e.LPOsum=function(t,n){e.detailsData.total=parseFloat(t)*parseFloat(n)},e.clearForm=function(){e.formData={pprojectid:0,pjobtypeid:1,details:[]},e.lpoData={pprojectid:0,pjobtypeid:2,details:[]},e.instantData={pprojectid:0,pjobtypeid:3,details:[]},i.defaults("contract").then(function(t){e.formData.cpccontractconfigurationid=o.get(t).cpccontractconfigurationid,e.formData.cpcreferencetype=o.get(t).cpcreferencetype},function(e){}),i.defaults("onetime").then(function(t){e.lpoData.opconetimeconfigurationid=o.get(t).opconetimeconfigurationid,e.lpoData.opcreferencetype=o.get(t).opcreferencetype,e.lpoData.opcreferencetype=e.lpoData.opcreferencetype},function(e){}),i.defaults("instant").then(function(t){e.instantData.ipcprojectconfigurationid=o.get(t).ipcprojectconfigurationid,e.instantData.ipcreferencetype=o.get(t).ipcreferencetype,e.instantData.ipcreferencetype=e.instantData.ipcreferencetype},function(e){}),i.dfTemplate().then(function(t){e.formData.pcontracttemplateid=o.get(t).ctcontracttemplateid,i.getBody(e.formData.pcontracttemplateid).then(function(t){angular.forEach(o.get(t),function(t){e.formData.pdescriptiontop=t.ctdescriptiontop,e.formData.pdescriptionbottom=t.ctdescriptionbottom})},function(e){})},function(e){})},e.suspended=!1,e.resume=!1,e.suspend=function(t,n){$("#contract").modal("hide"),$("#instantForm").modal("hide"),$("#lpoForm").modal("hide"),swal({title:"Reason!",text:"Write a Reason to Suspend:",type:"input",showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top",inputPlaceholder:"Write Reason"},function(s){if(!1===s){switch(n){case"c":$("#contract").modal("show");break;case"l":$("#lpoForm").modal("show");break;case"i":$("#instantForm").modal("show")}return!1}if(""===s)return swal.showInputError("You need to write something!"),!1;i.suspend(t,s).then(function(t){a.start(),r.custom("success","Project Suspended","Project"),e.suspended=!1,swal("Nice!","You wrote: "+s,"success"),i.findlist(e.filterData).then(function(t){e.projects=o.get(t),a.complete()},function(e){})},function(e){})})},e.resumeProject=function(t){a.start(),i.resume(t).then(function(t){r.custom("success","Project Resumed","Project"),e.resume=!1,i.findlist(e.filterData).then(function(t){e.projects=o.get(t),a.complete(),$("#contract").modal("hide"),$("#instantForm").modal("hide"),$("#lpoForm").modal("hide")},function(e){})},function(e){})},e.applyTemplate=function(t){a.start(),i.getBody(t).then(function(t){angular.forEach(o.get(t),function(t){e.formData.pdescriptiontop=t.ctdescriptiontop,e.formData.pdescriptionbottom=t.ctdescriptionbottom,a.complete(),r.custom("success","New Template Applied!","Template")})},function(e){})},e.findContractTotalJobs=function(t){var n=e.formData.pbaseperiodid,o=e.formData.pperiod,i=0,r=0;return angular.forEach(t,function(e){e.pdfrequencyperiodid==n?(r=Number(e.pdfrequency)*o,e.pdtotaljobs=r):(r=Number(e.pdfrequency)*o*12,e.pdtotaljobs=r),i+=r}),i},e.srreq=!1,e.cpushDetail=function(){""==e.detailsData.srid||null==e.detailsData.srid?(r.custom("error","Service Required!","Details"),e.srreq=!0):(e.formData.details.push({pdprojectdetailid:"0",pdserviceid:e.detailsData.srid,pdprojectid:e.formData.pprojectid,pdjobsiteid:e.formData.pjobsiteid,pdservicedescription:e.detailsData.desc,pdunit:e.detailsData.unit,pdrate:e.detailsData.rate,pdfrequency:e.detailsData.frequency,pdfrequencyperiodid:e.detailsData.basePeriod,pdtotal:e.detailsData.total}),e.srreq=!1,e.detailsData={},r.custom("success","Details Successfully Added!","Project!"),$("#focus").focus())},e.detailEdit=function(t){e.formData.details=[],console.log(t.pdfrequency),e.formData.details.push({pdprojectdetailid:t.pdprojectdetailid,pdserviceid:t.pdserviceid,pdprojectid:t.pdprojectid,pdjobsiteid:t.pdjobsiteid,pdservicedescription:t.pdservicedescription,pdunit:t.pdunit,pdrate:t.pdrate,pdfrequency:t.pdfrequency,pdfrequencyperiodid:t.pdfrequencyperiodid,pdtotal:t.pdtotal,isedit:1}),console.log(e.formData)},e.saveContract=function(){console.log(e.formData),a.start(),e.formData.details.length<1?(a.complete(),r.custom("error","Minimum One Details Required!","Details")):(e.formData.ptotaljobs=e.findContractTotalJobs(e.formData.details),console.log(e.formData),i.save(e.formData).then(function(t){console.log("save"),console.log(t),e.clearForm(),a.complete(),$("#contract").modal("hide"),r.custom("success","Project Successfully Saved!","Project"),i.findlist(e.filterData).then(function(t){e.projects=o.get(t),e.doPagination(e.projects)},function(e){})},function(e){console.log("error"),console.log(e)}))},e.editRow=function(t){a.start();var n,r,s=0;i.show(t).then(function(t){switch(o.get(t).pstatusid){case"14":e.resume=!0;break;default:e.suspended=!0}r=o.get(t),2==s?(r.details=n,e.formData=r,$("#contract").modal("show"),a.complete()):s=1},function(e){}),i.details(t).then(function(t){n=o.get(t),1==s?(r.details=n,e.formData=r,$("#contract").modal("show"),a.complete()):s=2},function(e){})},e.CgrandTotal=function(){for(var t=0,n=0;n<e.formData.details.length;n++){var o=e.formData.details[n];t+=parseFloat(o.pdtotal)}return e.formData.pgrandtotal=t,t},e.LgrandTotal=function(){for(var t=0,n=0;n<e.lpoData.details.length;n++){var o=e.lpoData.details[n];t+=parseFloat(o.pdtotal)}return e.formData.pgrandtotal=t,t},e.IgrandTotal=function(){for(var t=0,n=0;n<e.instantData.details.length;n++){var o=e.instantData.details[n];t+=parseFloat(o.pdtotal),e.formData.pgrandtotal=t}return t},e.cremoveDetail=function(t){e.formData.details.splice(t,1),r.custom("error","Details Successfully Removed!","Project!"),$("#focus").focus()},e.opushDetail=function(){""==e.detailsData.srid||null==e.detailsData.srid?(r.custom("error","Service Required!","Details"),e.srreq=!0):(e.lpoData.details.push({pdprojectdetailid:"0",pdserviceid:e.detailsData.srid,pdprojectid:e.formData.pprojectid,pdjobsiteid:e.formData.pjobsiteid,pdservicedescription:e.detailsData.desc,pdunit:e.detailsData.unit,pdrate:e.detailsData.rate,pdfrequencyperiodid:e.detailsData.frequency,pdtotaljobs:"1",pdtotal:e.detailsData.total}),e.srreq=!1,e.detailsData={},r.custom("success","Details Successfully Added!","Project!"),$("#focus").focus())},e.oremoveDetail=function(t){e.lpoData.details.splice(t,1),r.custom("error","Details Successfully Removed!","Project!"),$("#focus").focus()},e.ipushDetail=function(){""==e.detailsData.srid||null==e.detailsData.srid?(r.custom("error","Service Required!","Details"),e.srreq=!0):(e.instantData.details.push({pdprojectdetailid:"0",pdserviceid:e.detailsData.srid,pdprojectid:e.formData.pprojectid,pdjobsiteid:e.formData.pjobsiteid,pdservicedescription:e.detailsData.desc,pdunit:e.detailsData.unit,pdrate:e.detailsData.rate,pdfrequencyperiodid:e.detailsData.frequency,pdtotaljobs:"1",pdtotal:e.detailsData.total}),e.srreq=!1,e.detailsData={},r.custom("success","Details Successfully Added!","Project!"),$("#focus").focus())},e.iremoveDetail=function(t){e.instantData.details.splice(t,1),r.custom("error","Details Successfully Removed!","Project!"),$("#focus").focus()},e.saveLPO=function(){console.log(e.formData),a.start(),e.lpoData.ptotaljobs=e.lpoData.details.length,e.lpoData.details.length<1?(a.complete(),r.custom("error","Minimum One Details Required!","Details")):i.save(e.lpoData).then(function(t){o.get(t).success?(e.clearForm(),a.complete(),$("#lpoForm").modal("hide"),r.custom("success","Project Successfully Saved!","Project"),i.findlist(e.filterData).then(function(t){e.projects=o.get(t),e.doPagination(e.projects)},function(e){})):"UQ_LPOReference_notnull"==o.get(t).message?r.custom("error","LPO Reference  Already Exists!","Project"):"UQ_ProjectReference"==o.get(t).message?r.custom("error","Project Reference  Already exists!","Project"):r.custom("error","Something Wrong!","Project")},function(e){})},e.editLPO=function(t){a.start();var n,r,s=0;i.show(t).then(function(t){r=o.get(t),2==s?(r.details=n,e.lpoData=r,$("#lpoForm").modal("show"),a.complete()):s=1},function(e){}),i.details(t).then(function(t){n=o.get(t),1==s?(r.details=n,e.lpoData=r,$("#lpoForm").modal("show"),a.complete()):s=2},function(e){})},e.saveInstant=function(){a.start(),e.instantData.ptotaljobs=e.instantData.details.length,e.instantData.details.length<1?(a.complete(),r.custom("error","Minimum One Details Required!","Details")):i.save(e.instantData).then(function(t){o.get(t).success?(e.clearForm(),a.complete(),$("#instantForm").modal("hide"),r.custom("success","Project Successfully Saved!","Project"),i.findlist(e.filterData).then(function(t){e.projects=o.get(t),e.doPagination(e.projects)},function(e){})):(a.complete(),"UQ_ProjectReference"==o.get(t).message?r.custom("error","Project Reference  Already Exists!","Project"):r.custom("error","Something went wrong!","Project"))},function(e){a.complete()})},e.editInstant=function(t){a.start();var n,r,s=0;i.show(t).then(function(t){r=o.get(t),2==s?(r.details=n,e.instantData=r,$("#instantForm").modal("show"),a.complete()):s=1},function(e){}),i.details(t).then(function(t){n=o.get(t),1==s?(r.details=n,e.instantData=r,$("#instantForm").modal("show"),a.complete()):s=2},function(e){})},e.deleteContract=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Project?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?i.destroy(t).then(function(t){$("#contract").modal("hide"),$("#instantForm").modal("hide"),$("#lpoForm").modal("hide"),swal("Deleted!","Project Successfully Deleted","success"),i.findlist(e.filterData).then(function(t){e.projects=o.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},e.exportData=function(t){var n={};console.log(t),i.exportProject(t).then(function(e){n=o.get(e),console.log(n)},function(e){}),i.exportProjectDetails(t).then(function(e){n.details=o.get(e)},function(e){}),i.company().then(function(t){n.company=o.get(t),e.makePdf(n)},function(e){})},e.makePdf=function(e){console.log(e);var t=[];t.push([{text:"Service",style:"headers"},{text:"Unit",style:"headers"},{text:"Rate",style:"headers"},{text:"Frequency",style:"headers"},{text:"Total",style:"headers"}]),angular.forEach(e.details,function(e){var n=e.pdfrequency>1?"s":"";t.push([{text:e.service+"\n"+e.pdservicedescription,style:"tbodyRows",border:[!0,!0,!0,!0]},{text:e.pdunit.toString(),style:"tbodyRows"},{text:e.pdrate.toString(),style:"tbodyRows"},{text:e.pdfrequency.toString()+"/"+(e.pdfrequencyperiodid>1?"Month"+n:"Year"+n),style:"tbodyRows"},{text:e.pdtotal.toString(),style:"tbodyRows"}])}),t.push([{text:"Grand Total",alignment:"right",color:"#black",margin:[0,3,0,0],colSpan:4},{},{},{},{text:e.pgrandtotal,alignment:"center",margin:[0,3,0,0]}]);var o={content:[{columns:[{width:"*",text:""},{width:"*",text:"Contract",alignment:"center",bold:!0,fontSize:20},{width:"*",text:""}],margin:[0,null==e.toppadding?100:parseInt(e.toppadding),0,0]},{columns:[{text:"From",bold:!0,fontSize:16},{text:"To",alignment:"right",bold:!0,fontSize:16}]},{columns:[{text:n("capitalize")(e.company.tcompanyname)+"\n"+n("capitalize")(e.company.taddress)+"\n"+e.company.tphone+"\n"+e.company.temail+"\n",fontSize:14},{text:n("capitalize")(e.customer)+"\n"+n("capitalize")(e.address)+"\n"+e.phone+"\n"+e.email,alignment:"right",fontSize:14}],margin:[0,0,0,10]},{columns:[{text:null==e.pdescriptiontop?"":e.pdescriptiontop.replace(/<\/?[^>]+(>|$)/g,""),fontSize:12}],margin:[0,20,0,20]},{table:{headerRows:1,widths:["*","*","*","*","*"],body:t},layout:"lightHorizontalLines",margin:[0,0,0,5]},{text:"Total Charged : "+e.pgrandtotal+" (AED) ("+n("toWords")(e.pgrandtotal)+")",margin:10},{columns:[{text:null==e.pdescriptionbottom?"":e.pdescriptionbottom.replace(/<\/?[^>]+(>|$)/g,""),fontSize:12}],margin:[0,0,0,20]},{columns:[{width:"*",text:"Name :"},{width:"*",text:""},{width:"*",text:"Name :"}]},{columns:[{width:"*",text:"Signature :"},{width:"*",text:""},{width:"*",text:"Signature :"}],margin:[0,0,0,null==e.bottompadding?100:parseInt(e.bottompadding)]}],styles:{headers:{alignment:"center",margin:[0,0,0,2],bold:!0},tbodyRows:{alignment:"center",margin:[0,3,0,3],italic:!0}}};c.print(o)}}]),app.factory("Project",["$http",function(e){return{get:function(){return e.get("sim/pm/project")},show:function(t){return e.get("sim/pm/project/"+t)},suspend:function(t,n){return e.post("sim/pm/project/suspended/"+t+"/"+n)},resume:function(t){return e.post("sim/pm/project/resume/"+t)},save:function(t){return e({method:"POST",url:"sim/pm/project",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},exportProject:function(t){return e.get("sim/pm/project/export/"+t)},exportProjectDetails:function(t){return e.get("sim/pm/project/detail/export/"+t)},getBody:function(t){return e.get("sim/pms/template/contract/body/"+t)},users:function(){return e.get("sim/sap/user/ddmenu")},status:function(){return e.get("sim/ddmenu/pm/status")},jobtype:function(){return e.get("sim/ddmenu/pm/jobtype")},dfTemplate:function(){return e.get("sim/pms/template/contract/defualtid")},details:function(t){return e.get("sim/pm/project/detail/"+t)},findlist:function(t){return e({method:"POST",url:"sim/pm/project/findlist",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},defaults:function(t){return e.get("sim/pms/config/project/"+t+"/list")},CtTemplates:function(){return e.get("sim/pms/template/contract/ddmenu")},destroy:function(t){return e({method:"POST",url:"sim/pm/project/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},customer:function(){return e.get("sim/sm/customer/ddmenu")},company:function(){return e.get("M@ster786/tenant/company/primary")},attentions:function(){return e.get("sim/sm/customer/attention/ddmenu")},jobsites:function(){return e.get("sim/sm/jobsite/ddmenu")},employees:function(){return e.get("sim/hm/employee/ddmenu")},branches:function(){return e.get("sim/hm/branch/ddmenu")},service:function(){return e.get("sim/sm/service/ddmenu")}}}]),app.controller("quotationCtrl",["$scope","$http","$filter","Data","Quotation","notify","cfpLoadingBar","AccessFactory","$state","genPDF",function(e,t,n,o,r,a,s,c,l,u){e.filterData={qstatusid:2},e.detailsData={rate:0,unit:0,frequency:0},e.formData={qquotationid:0,details:[]},console.log(e.formData),r.templates().then(function(t){e.templates=o.get(t)},function(e){}),r.customer().then(function(t){e.customers=o.get(t)},function(e){}),r.users().then(function(t){e.users=o.get(t)},function(e){}),r.status().then(function(t){e.status=o.get(t)},function(e){}),r.attentions().then(function(t){e.attentions=o.get(t)},function(e){}),r.jobsites().then(function(t){e.jobsites=o.get(t)},function(e){}),r.employees().then(function(t){e.employees=o.get(t)},function(e){}),e.test=function(e){},e.doSum=function(t,n,o){var i;return i=e.formData.qjobtypeid>1?parseFloat(t)*parseFloat(n)*parseFloat(o):parseFloat(t)*parseFloat(n),e.detailsData.total=i},e.doSumOnline=function(t,n,o){e.formData.details.qdtotal=parseFloat(t)*parseFloat(n)*parseFloat(o)},r.branches().then(function(t){e.branches=o.get(t)},function(e){}),r.service().then(function(t){e.services=o.get(t)},function(e){}),s.start(),r.findList(e.filterData).then(function(t){e.quotations=o.get(t),e.doPagination(e.quotations),s.complete()},function(e){s.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.clearForm=function(){e.formData={qquotationid:0,details:[]},r.dfReference().then(function(t){e.formData.qcreferencetype=o.get(t).qcreferencetype,e.formData.qcquotationconfigurationid=o.get(t).qcquotationconfigurationid,e.formData.qvaliduntil=o.fmDate(o.get(t).qcquotationvaliditydays),e.formData.qquoteddate=o.fmDate(str=null)},function(e){}),r.dfTemplate().then(function(t){e.formData.qquotationtemplateid=o.get(t).qtquotationtemplateid,r.getBody(e.formData.qquotationtemplateid).then(function(t){angular.forEach(o.get(t),function(t){e.formData.qdescriptiontop=t.qtdescriptiontop,e.formData.qdescriptionbottom=t.qtdescriptionbottom})},function(e){})},function(e){}),console.log(e.formData)},e.applyTemplate=function(t){r.getBody(t).then(function(t){angular.forEach(o.get(t),function(t){e.formData.qdescriptiontop=t.qtdescriptiontop,e.formData.qdescriptionbottom=t.qtdescriptionbottom,a.custom("success","New Template Applied!","Quotation")})},function(e){})},e.searchList=function(){r.findList(e.filterData).then(function(t){e.quotations=o.get(t)},function(e){})},e.saveQuotation=function(){console.log(e.formData.details);var t=0;for(i=0;i<e.formData.details.length;i++)t+=Number(e.formData.details[i].qdtotal);e.formData.qgrandtotal=t,s.start(),e.formData.details.length<1?a.custom("error","Minimum One Details Required!","Details"):(console.log(e.formData),r.save(e.formData).then(function(t){console.log(o.get(t)),o.get(t).success?(e.clearForm(),s.complete(),$("#myModal").modal("hide"),a.custom("success","Quotation Successfully Saved!","Quotation"),r.findList(e.filterData).then(function(t){e.quotations=o.get(t),e.doPagination(e.quotations)},function(e){})):(s.complete(),"UQ_QuotationReference"==o.get(t).message?a.custom("error","Quotation Reference Code Already Exists!","Quotation"):a.custom("error","Something went wrong!","Quotation"))},function(e){}))},e.editRow=function(t){e.id=t,s.start();var n,i,a=0;r.show(t).then(function(t){i=o.get(t),2==a?(i.details=n,e.formData=i,$("#myModal").modal("show"),s.complete()):a=1},function(e){}),r.details(t).then(function(t){n=o.get(t),console.log(n),1==a?(i.details=n,e.formData=i,$("#myModal").modal("show"),s.complete()):a=2},function(e){}),r.changecolumn(t).then(function(t){e.values=o.get(t),"1"==e.values.qhasunit?e.unitenable=!0:e.unitenable=!1,"1"==e.values.qhasrate?e.rateenable=!0:e.rateenable=!1,"1"==e.values.qhasfrequency?e.frequencyenable=!0:e.frequencyenable=!1,"1"==e.values.qhasmultiplejobsite?e.multiplejobsiteenable=!0:e.multiplejobsiteenable=!1,e.formData.qhascombo=e.values.qhascombo,e.formData.qhasrate=e.values.qhasrate,e.formData.qhasunit=e.values.qhasunit,e.formData.qhasfrequency=e.values.qhasfrequency,e.formData.qhasmultiplejobsite=e.values.qhasmultiplejobsite},function(e){})};e.formData.qhasunit;e.combenable=!0,e.rateenable=!0,e.unitenable=!0,e.multiplejobsiteenable=!1,e.changecolmn=function(t,n){"combo"==n&&(e.formData.qhascombo=t),"rate"==n&&(e.formData.qhasrate=t),"unit"==n&&(e.formData.qhasunit=t),"frequency"==n&&(e.formData.qhasfrequency=t),"multiplejobsite"==n&&(e.formData.qhasmultiplejobsite=t);var o=t+n;"truecombo"==o&&(e.combenable=!0),"falsecombo"==o&&(e.combenable=!1),"truerate"==o&&(e.rateenable=!0),"falserate"==o&&(e.rateenable=!1),"trueunit"==o&&(e.unitenable=!0),"falseunit"==o&&(e.unitenable=!1),"truefrequency"==o&&(e.frequencyenable=!0),"falsefrequency"==o&&(e.frequencyenable=!1),"truemultiplejobsite"==o&&(e.multiplejobsiteenable=!0),"falsemultiplejobsite"==o&&(e.multiplejobsiteenable=!1)},e.srreq=!1,e.pushDetail=function(){""==e.detailsData.srid||null==e.detailsData.srid?(a.custom("error","Service Required!","Details"),e.srreq=!0):(console.log(e.detailsData),e.formData.details.push({qdquotationdetailid:"0",qdserviceid:e.detailsData.srid,qdquotationid:e.formData.qquotationid,qdjobsiteid:e.formData.qjobsiteid,qdservicedescription:e.detailsData.desc,qdunit:e.detailsData.unit,qdrate:e.detailsData.rate,qdfrequency:e.detailsData.frequency,qdfrequencyperiodid:e.detailsData.base,qdtotal:e.detailsData.total}),e.srreq=!1,e.detailsData={},a.custom("success","Details Successfully Added!","Details"),$("#focus").focus())},e.grandTotal=function(){for(var t=0,n=0;n<e.formData.details.length;n++){var o=e.formData.details[n];t+=parseFloat(o.qdtotal)}return t},e.removeDetail=function(t){e.formData.details.splice(t,1),a.custom("error","Details Successfully Removed!","Quotation!"),$("#focus").focus()},e.deleteRow=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Quotation?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?r.destroy(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","Quotation Successfully Deleted","success"),r.findList(e.filterData).then(function(t){e.quotations=o.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},e.exportData=function(t){var n={};r.exportQuotation(t).then(function(e){n=o.get(e)},function(e){}),r.exportQuotationDetails(t).then(function(e){n.details=o.get(e)},function(e){}),r.company().then(function(t){n.company=o.get(t),e.makePdf(n)},function(e){})},e.makePdf=function(e){console.log(e);var t=[];t.push([{text:"Description",style:"headers",border:[!0,!0,!0,!0]},{text:"Unit",style:"headers"},{text:"Rate",style:"headers"},{text:"Frequency",style:"headers"},{text:"Total",style:"headers"}]),angular.forEach(e.details,function(e){var n=e.qdfrequency>1?"s":"";t.push([{text:e.service+",\n"+e.qdservicedescription,style:"tbodyRows",border:[!0,!0,!0,!0]},{text:e.qdunit.toString(),style:"tbodyRows"},{text:e.qdrate.toString(),style:"tbodyRows"},{text:e.qdfrequency.toString()+"/"+(e.qdfrequency>1?"Month"+n:"Year"+n),style:"tbodyRows"},{text:e.qdtotal.toString(),style:"tbodyRows"}])}),t.push([{text:"Grand Total",alignment:"right",color:"black",margin:[0,3,0,0],bold:!0,colSpan:4},{},{},{},{text:e.qgrandtotal,alignment:"center",margin:[0,3,0,0]}]);var o={content:[{columns:[{width:"*",text:""},{width:"*",text:"Quotation",alignment:"center",bold:!0,fontSize:20},{width:"*",text:""}],margin:[0,null==e.toppadding?100:parseInt(e.toppadding),0,0]},{columns:[{text:"From",bold:!0,fontSize:16},{text:"To",alignment:"right",bold:!0,fontSize:16}]},{columns:[{text:n("capitalize")(e.company.tcompanyname)+"\n"+n("capitalize")(e.company.taddress)+"\n"+e.company.tphone+"\n"+e.company.temail+"\n",fontSize:14},{text:n("capitalize")(e.customer)+"\n"+n("capitalize")(e.address)+"\n"+e.phone+"\n"+e.email,alignment:"right",fontSize:14}],margin:[0,0,0,10]},{columns:[{text:null==e.qdescriptiontop?"":e.qdescriptiontop.replace(/<\/?[^>]+(>|$)/g,""),fontSize:12}],margin:[0,20,0,20]},{table:{headerRows:1,widths:["*","*","*","*","*"],body:t},layout:"lightHorizontalLines",margin:[0,0,0,5]},{text:"Total Charged : "+e.qgrandtotal+" (AED) ("+n("toWords")(e.qgrandtotal)+")",margin:[0,0,0,10]},{columns:[{text:null==e.qdescriptionbottom?"":e.qdescriptionbottom.replace(/<\/?[^>]+(>|$)/g,""),fontSize:12}],margin:[0,0,0,20]},{columns:[{width:"*",text:"Name :"},{width:"*",text:""},{width:"*",text:"Name :"}]},{columns:[{width:"*",text:"Signature :"},{width:"*",text:""},{width:"*",text:"Signature :"}],margin:[0,0,0,null==e.bottompadding?100:parseInt(e.bottompadding)]}],styles:{headers:{alignment:"center",margin:[0,0,0,2],bold:!0},tbodyRows:{alignment:"center",margin:[0,3,0,3],italic:!0}}};u.print(o)}}]),app.factory("Quotation",["$http",function(e){return{get:function(){return e.get("sim/pm/quotation")},show:function(t){return e.get("sim/pm/quotation/"+t)},users:function(){return e.get("sim/sap/user/ddmenu")},status:function(){return e.get("sim/ddmenu/pm/status")},save:function(t){return e({method:"POST",url:"sim/pm/quotation",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},findList:function(t){return e({method:"POST",url:"sim/pm/quotation/findlist",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},dfTemplate:function(){return e.get("sim/pms/template/quotation/defualtid")},dfReference:function(){return e.get("sim/pms/config/quotation/list")},getBody:function(t){return e.get("sim/pms/template/quotation/body/"+t)},details:function(t){return e.get("sim/pm/quotation/detail/getlist/"+t)},templates:function(){return e.get("sim/pms/template/quotation/ddmenu")},destroy:function(t){return e({method:"POST",url:"sim/pm/quotation/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},customer:function(){return e.get("sim/sm/customer/ddmenu")},company:function(){return e.get("M@ster786/tenant/company/primary")},attentions:function(){return e.get("sim/sm/customer/attention/ddmenu")},jobsites:function(){return e.get("sim/sm/jobsite/ddmenu")},employees:function(){return e.get("sim/hm/employee/ddmenu")},branches:function(){return e.get("sim/hm/branch/ddmenu")},service:function(){return e.get("sim/sm/service/ddmenu")},changecolumn:function(t){return e.get("sim/pm/quotation/"+t)},exportQuotation:function(t){return e.get("sim/pm/quotation/export/"+t)},exportQuotationDetails:function(t){return e.get("sim/pm/quotation/detail/export/"+t)}}}]),app.controller("taskCtrl",["$scope","$rootScope","$http","$log","Task","Data","notify","cfpLoadingBar","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c,l){e.groupData={tgtaskgroupid:0},e.taskForm={tktaskid:0,users:[]},e.ok=function(e){console.log(e)},e.clearForm=function(){e.taskForm={tktaskid:0,users:[]},e.groupData={tgtaskgroupid:0},$(".notify").prop("checked",!1)},i.employees().then(function(t){console.log("users"),e.employees=r.get(t)},function(e){}),s.start(),i.get("taskgroup").then(function(t){e.taskGroup=r.get(t),s.complete()},function(e){s.complete()}),i.users().then(function(t){e.users=r.get(t)},function(e){}),e.selected_baselines=[],e.selected_baseline_settings={template:'<p id="selected{{option.suuserid}} " ><b><span  >{{option.suuserid}}</span>{{option.suusername}}</b></p>',searchField:"name",enableSearch:!0,selectedToTop:!0},console.log(e.selected_userid),e.selected_baselines_customTexts={buttonDefaultText:"Select Users"},console.log(e.selected_baselines_customTexts),e.addTask=function(t){e.taskData={tktaskid:"0",tktaskgroupid:t,tkdescription:$(".taskDesc"+t).summernote("code"),tktask:$(".addTask"+t).val(),tkassignedemployeeid:$(".assign"+t).val(),tkisnotifyassigner:$(".notif"+t).val(),tkduedate:$(".due"+t).val()},i.save("task",e.taskData).then(function(n){$(".addTask"+t).val("").focus(),$(".taskDesc"+t).summernote("code",""),a.success(),i.get("taskgroup").then(function(t){e.taskGroup=r.get(t)},function(e){})},function(e){})},e.selecteddata=[],e.changevalues=function(t){angular.element(document).ready(function(){$(document).on("change",".notify",function(){if(this.checked)e.utuserid=t.suuserid,e.taskForm.tktaskid,e.taskForm.users.push({utuserid:e.utuserid,uttaskid:e.taskid,utisnotify:1,utisremovable:0});else{e.utuserid=t.suuserid;for(var n=0;n<e.taskForm.users.length;n++)e.taskForm.users[n].utuserid==e.utuserid&&e.taskForm.users.splice(n,1)}})})},e.taskids=function(t){console.log(t),e.taskid=t},e.newTask=function(){console.log(e.taskForm),s.start(),i.save("task",e.taskForm).then(function(t){i.get("taskgroup").then(function(t){e.clearForm(),s.complete(),$("#newTask").modal("hide"),a.success(),e.taskGroup=r.get(t)},function(e){})},function(e){})},e.editTask=function(t){e.taskid=t,s.start(),i.show("task",t).then(function(t){e.taskForm=r.get(t),console.log(e.taskForm.users),angular.forEach(e.taskForm.users,function(t){e.selected_userid=t.utuserid,console.log(e.selected_userid),angular.element(document).ready(function(){$("input:checkbox[value="+e.selected_userid+"]").prop("checked",!0)})}),s.complete(),$("#newTask").modal("show")},function(e){})},e.deleteTask=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Task?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?i.destroy("task",t).then(function(t){swal("Deleted!","Task Successfully Deleted","success"),i.get("taskgroup").then(function(t){e.taskGroup=r.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},e.newGroup=function(){s.start(),console.log(e.groupData),i.save("taskgroup",e.groupData).then(function(t){i.get("taskgroup").then(function(t){a.success(),e.clearForm(),s.complete(),$("#newGroup").modal("hide"),e.taskGroup=r.get(t),console.log(e.taskGroup)},function(e){})},function(e){})},e.editGroup=function(t){console.log(t),s.start(),i.show("taskgroup",t).then(function(t){e.groupData=r.get(t),s.complete(),$("#newGroup").modal("show")},function(e){})},e.deleteGroup=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Group?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?i.destroy("taskgroup",t).then(function(t){swal("Deleted!","Group Successfully Deleted","success"),i.get("taskgroup").then(function(t){e.taskGroup=r.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},angular.element(document).ready(function(){$(".dropdown dd ul li").each(function(e,t){console.log(t)}),$(".dropdown dt a").on("click",function(){$(".dropdown dd ul").slideToggle("fast")}),$(".dropdown dd ul li a").on("click",function(){$(".dropdown dd ul").hide()}),$(document).bind("click",function(e){$(e.target).parents().hasClass("dropdown")||$(".dropdown dd ul").hide()}),$('.mutliSelect input[type="checkbox"]').on("click",function(){var e=$(this).closest(".mutliSelect").find('input[type="checkbox"]').val(),e=$(this).val()+",";if($(this).is(":checked")){var t='<span title="'+e+'">'+e+"</span>";$(".multiSel").append(t),$(".hida").hide()}else{$('span[title="'+e+'"]').remove();var n=$(".hida");console.log(n),$(".dropdown dt a").append(n)}})})}]),app.factory("Task",["$http",function(e){return{get:function(t){return e.get("sim/pm/"+t)},show:function(t,n){return e.get("sim/pm/"+t+"/"+n)},save:function(t,n){return e({method:"POST",url:"sim/pm/"+t,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},destroy:function(t,n){return e({method:"POST",url:"sim/pm/"+t+"/"+n,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},filterTask:function(e){var t;return angular.forEach(e,function(e){t=e.hmtasks}),t},employees:function(){return e.get("sim/hm/employee/ddmenu")},users:function(){return e.get("sim/sap/user/ddmenu")},findlist:function(t){return e({method:"POST",url:"sim/sut/contactbook/findlist",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})}}}]),app.controller("configCtrl",["$scope","$http","$log","Config","Data","notify","cfpLoadingBar",function(e,t,n,o,i,r,a){var s=-1,c=new Date;e.customShow=!0,e.suffixCusomShow=!0,e.showPreviewButton=!0,e.showPreivew=!1,e.delmiterShow=!0,e.selectedPrefs=[],e.selectedSufs=[],e.prefNsuf=[{value:"branch",text:"BranchCode ",attr:!0,period:0},{value:"user",text:"UserCode ",attr:!0,period:0},{value:"custom",text:"CustomCode ",attr:!0,period:0},{value:"customer",text:"CustomerCode ",attr:!0,period:0},{value:"company",text:"CompanyCode ",attr:!0,period:0},{value:"service",text:"ServiceCode ",attr:!0,period:0},{value:"department",text:"DepartmentCode ",attr:!0,period:0},{value:"delimeter",text:"Delimiter ",attr:!0,period:0},{value:"day1",text:"Day(D) ",attr:!0,period:4},{value:"day2",text:"Day(DD) ",attr:!0,period:4},{value:"month1",text:"Month(M) ",attr:!0,period:2},{value:"month2",text:"Month(MM) ",attr:!0,period:2},{value:"year2",text:"Year(YY) ",attr:!0,period:1},{value:"year4",text:"Year(YYYY) ",attr:!0,period:1}],e.periodCity=[{value:"0",text:"None"}],a.start(),e.checkPeriods=function(t){var n=!1;return angular.forEach(e.selectedPrefs,function(e){e.period!=t||(n=!0)}),angular.forEach(e.selectedSufs,function(e){e.period!=t||(n=!0)}),n},e.makePcity=function(){e.periodCity=[],e.periodCity.push({value:0,text:"None"}),e.checkPeriods(1)&&(e.periodCity.push({value:1,text:"Yearly"}),e.checkPeriods(2)&&(e.periodCity.push({value:2,text:"Monthly"}),e.checkPeriods(4)&&e.periodCity.push({value:4,text:"Daily"})))},e.changeAffixesAttribute=function(t){angular.forEach(t.split(","),function(t){angular.forEach(e.prefNsuf,function(e){e.value==t&&(e.attr=!1)})})},e.zeroFill=function(e,t,n){if(slength=String(t).length,slength<n&&e){for(n-=slength;n--;)t="0"+t;s=t}else s=t},e.prefixesAndSuffixesFromRemote=function(t,n){null==t&&(t=","),angular.forEach(t.split(","),function(t){angular.forEach(e.prefNsuf,function(o){t!=o.value||(n?e.selectedPrefs.push(o):e.selectedSufs.push(o))})})},e.clearaffixes=function(){e.selectedPrefs=[],e.selectedSufs=[]},e.addPref=function(t,n){e.selectedPrefs.push(t),e.makePcity()},e.removePref=function(t,n){e.selectedPrefs.splice(n,1),e.makePcity()},e.addSufs=function(t,n){e.selectedSufs.push(t),e.makePcity()},e.removeSuf=function(t,n){e.selectedSufs.splice(n,1),e.makePcity()},e.quotationConfig=function(){a.start(),e.clearaffixes(),o.get("quotation").then(function(t){e.formData=i.get(t),e.prefixesAndSuffixesFromRemote(i.get(t).qcreferenceprefixpattern,!0),e.prefixesAndSuffixesFromRemote(i.get(t).qcreferencesuffixpattern,!1),e.makePcity(),a.complete();var n=0;angular.forEach(e.periodCity,function(t){t.value==e.formData.qcperiodicityid&&(n=1,e.formData.qcperiodicityid=t.value)}),0==n&&(e.formData.qcperiodicityid=0)},function(e){a.complete()})},e.saveQuotation=function(){a.start(),e.formData.qcreferenceprefixpattern="",angular.forEach(e.selectedPrefs,function(t){e.formData.qcreferenceprefixpattern+=t.value+","}),e.formData.qcreferenceprefixpattern=e.formData.qcreferenceprefixpattern.slice(0,-1),e.formData.qcreferencesuffixpattern="",angular.forEach(e.selectedSufs,function(t){e.formData.qcreferencesuffixpattern+=t.value+","}),e.formData.qcreferencesuffixpattern=e.formData.qcreferencesuffixpattern.slice(0,-1),o.save("quotation",e.formData).then(function(t){r.custom("success","Quotation Successfully Saved","Quotation"),e.quotationConfig(),a.complete()},function(e){r.custom("error","Error Occured While Saving","Quotation!"),a.complete()})},e.contractConfig=function(){a.start(),e.clearaffixes(),o.project("contract").then(function(t){e.ctData=i.get(t),e.prefixesAndSuffixesFromRemote(i.get(t).cpcreferenceprefixpattern,!0),e.prefixesAndSuffixesFromRemote(i.get(t).cpcreferencesuffixpattern,!1),e.makePcity(),a.complete(),a.complete();var n=0;angular.forEach(e.periodCity,function(t){t.value==e.ctData.cpcperiodicityid&&(n=1,e.ctData.cpcperiodicityid=t.value)}),0==n&&(e.ctData.cpcperiodicityid=0)},function(e){a.complete()})},e.saveContract=function(){a.start(),e.ctData.cpcreferenceprefixpattern="",angular.forEach(e.selectedPrefs,function(t){e.ctData.cpcreferenceprefixpattern+=t.value+","}),e.ctData.cpcreferenceprefixpattern=e.ctData.cpcreferenceprefixpattern.slice(0,-1),e.ctData.cpcreferencesuffixpattern="",angular.forEach(e.selectedSufs,function(t){e.ctData.cpcreferencesuffixpattern+=t.value+","}),e.ctData.cpcreferencesuffixpattern=e.ctData.cpcreferencesuffixpattern.slice(0,-1),o.projectSave("contract",e.ctData).then(function(t){r.custom("success","Contract Successfully Saved","Contract"),e.contractConfig(),a.complete()},function(e){r.custom("error","Error Occured While Saving","Contract!"),a.complete()})},e.invoiceConfig=function(){a.start(),e.changeAffixesAttribute("service"),e.clearaffixes(),o.config("invoice").then(function(t){e.invData=i.get(t),e.prefixesAndSuffixesFromRemote(i.get(t).icreferenceprefixpattern,!0),e.prefixesAndSuffixesFromRemote(i.get(t).icreferencesuffixpattern,!1),e.makePcity(),a.complete();var n=0;angular.forEach(e.periodCity,function(t){t.value==e.invData.icperiodicityid&&(n=1,e.invData.icperiodicityid=t.value)}),0==n&&(e.invData.icperiodicityid=0)},function(e){a.complete()})},e.saveInvoice=function(){a.start(),e.invData.icreferenceprefixpattern="",angular.forEach(e.selectedPrefs,function(t){e.invData.icreferenceprefixpattern+=t.value+","}),e.invData.icreferenceprefixpattern=e.invData.icreferenceprefixpattern.slice(0,-1),e.invData.icreferencesuffixpattern="",angular.forEach(e.selectedSufs,function(t){e.invData.icreferencesuffixpattern+=t.value+","}),e.invData.icreferencesuffixpattern=e.invData.icreferencesuffixpattern.slice(0,-1),o.save("invoice",e.invData).then(function(t){r.custom("success","Invoice Successfully Saved","Invoice"),e.invoiceConfig(),a.complete()},function(e){r.custom("error","Error Occured While Saving","Invoice!"),a.complete()})},e.jobConfig=function(){a.start(),e.clearaffixes(),o.config("job").then(function(t){e.jobData=i.get(t),e.prefixesAndSuffixesFromRemote(i.get(t).jcreferenceprefixpattern,!0),e.prefixesAndSuffixesFromRemote(i.get(t).jcreferencesuffixpattern,!1),e.makePcity(),a.complete();var n=0;angular.forEach(e.periodCity,function(t){t.value==e.jobData.jcperiodicityid&&(n=1,e.jobData.jcperiodicityid=t.value)}),0==n&&(e.jobData.jcperiodicityid=0)},function(e){a.complete()})},e.jobSaving=function(){a.start(),e.jobData.jcreferenceprefixpattern="",angular.forEach(e.selectedPrefs,function(t){e.jobData.jcreferenceprefixpattern+=t.value+","}),e.jobData.jcreferenceprefixpattern=e.jobData.jcreferenceprefixpattern.slice(0,-1),e.jobData.jcreferencesuffixpattern="",angular.forEach(e.selectedSufs,function(t){e.jobData.jcreferencesuffixpattern+=t.value+","}),e.jobData.jcreferencesuffixpattern=e.jobData.jcreferencesuffixpattern.slice(0,-1),o.save("job",e.jobData).then(function(t){r.custom("success","Job Successfully Saved","Job"),e.jobConfig(),a.complete()},function(e){r.custom("error","Error Occured While Saving","Job!"),a.complete()})},e.instantConfig=function(){a.start(),e.clearaffixes(),o.project("instant").then(function(t){e.instData=i.get(t),e.prefixesAndSuffixesFromRemote(i.get(t).ipcreferenceprefixpattern,!0),e.prefixesAndSuffixesFromRemote(i.get(t).ipcreferencesuffixpattern,!1),e.makePcity(),a.complete();var n=0;angular.forEach(e.periodCity,function(t){t.value==e.instData.ipcperiodicityid&&(n=1,e.instData.ipcperiodicityid=t.value)}),0==n&&(e.instData.ipcperiodicityid=0)},function(e){a.complete()})},e.saveInstant=function(){a.start(),e.instData.ipcreferenceprefixpattern="",angular.forEach(e.selectedPrefs,function(t){e.instData.ipcreferenceprefixpattern+=t.value+","}),e.instData.ipcreferenceprefixpattern=e.instData.ipcreferenceprefixpattern.slice(0,-1),e.instData.ipcreferencesuffixpattern="",angular.forEach(e.selectedSufs,function(t){e.instData.ipcreferencesuffixpattern+=t.value+","}),e.instData.ipcreferencesuffixpattern=e.instData.ipcreferencesuffixpattern.slice(0,-1),o.projectSave("instant",e.instData).then(function(t){r.custom("success","Instant Successfully Saved","Instant"),e.instantConfig(),a.complete()},function(e){r.custom("error","Error Occured While Saving","Instant!"),a.complete()})},e.expSheetConfig=function(){a.start(),e.changeAffixesAttribute("customer,service,department,branch"),e.clearaffixes(),o.config("expensesheet").then(function(t){e.expData=i.get(t),e.prefixesAndSuffixesFromRemote(i.get(t).escreferenceprefixpattern,!0),e.prefixesAndSuffixesFromRemote(i.get(t).escreferencesuffixpattern,!1),e.makePcity(),a.complete();var n=0;angular.forEach(e.periodCity,function(t){t.value==e.expData.escperiodicityid&&(n=1,e.expData.escperiodicityid=t.value)}),0==n&&(e.expData.escperiodicityid=0)},function(e){a.complete()})},e.saveExpSheet=function(){a.start(),e.expData.escreferenceprefixpattern="",angular.forEach(e.selectedPrefs,function(t){e.expData.escreferenceprefixpattern+=t.value+","}),e.expData.escreferenceprefixpattern=e.expData.escreferenceprefixpattern.slice(0,-1),e.expData.escreferencesuffixpattern="",angular.forEach(e.selectedSufs,function(t){e.expData.escreferencesuffixpattern+=t.value+","}),e.expData.escreferencesuffixpattern=e.expData.escreferencesuffixpattern.slice(0,-1),o.save("expensesheet",e.expData).then(function(t){r.custom("success","Expensesheet Successfully Saved","Expensesheet"),e.expSheetConfig(),a.complete()},function(e){r.custom("error","Error Occured While Saving","Expensesheet!"),a.complete()})},e.jobsheetConfig=function(){a.start(),e.clearaffixes(),o.config("jobsheet").then(function(t){e.jsData=i.get(t),e.prefixesAndSuffixesFromRemote(i.get(t).jscreferenceprefixpattern,!0),e.prefixesAndSuffixesFromRemote(i.get(t).jscreferenceprefixpattern,!1),e.makePcity(),a.complete();var n=0;angular.forEach(e.periodCity,function(t){t.value==e.jsData.jscperiodicityid&&(n=1,e.jsData.jscperiodicityid=t.value)}),0==n&&(e.jsData.jscperiodicityid=0)},function(e){a.complete()})},e.saveJobSheet=function(){a.start(),e.jsData.jscreferenceprefixpattern="",angular.forEach(e.selectedPrefs,function(t){e.jsData.jscreferenceprefixpattern+=t.value+","}),e.jsData.jscreferenceprefixpattern=e.jsData.jscreferenceprefixpattern.slice(0,-1),e.jsData.jscreferenceprefixpattern="",angular.forEach(e.selectedSufs,function(t){e.jsData.jscreferenceprefixpattern+=t.value+","}),e.jsData.jscreferenceprefixpattern=e.jsData.jscreferenceprefixpattern.slice(0,-1),o.save("jobsheet",e.jsData).then(function(t){r.custom("success","Jobsheet Successfully Saved","Jobsheet"),e.jobsheetConfig(),a.complete()},function(e){r.custom("error","Error Occured While Saving","Jobsheet!"),a.complete()})},e.onetimeConfig=function(){a.start(),e.clearaffixes(),o.project("onetime").then(function(t){e.oneTiData=i.get(t),e.prefixesAndSuffixesFromRemote(i.get(t).opcreferenceprefixpattern,!0),e.prefixesAndSuffixesFromRemote(i.get(t).opcreferencesuffixpattern,!1),e.makePcity(),a.complete();var n=0;angular.forEach(e.periodCity,function(t){t.value==e.oneTiData.opcperiodicityid&&(n=1,e.oneTiData.opcperiodicityid=t.value)}),0==n&&(e.oneTiData.opcperiodicityid=0)},function(e){a.complete()})},e.saveOneTime=function(){a.start(),e.oneTiData.opcreferenceprefixpattern="",angular.forEach(e.selectedPrefs,function(t){e.oneTiData.opcreferenceprefixpattern+=t.value+","}),e.oneTiData.opcreferenceprefixpattern=e.oneTiData.opcreferenceprefixpattern.slice(0,-1),e.oneTiData.opcreferencesuffixpattern="",angular.forEach(e.selectedSufs,function(t){e.oneTiData.opcreferencesuffixpattern+=t.value+","}),e.oneTiData.opcreferencesuffixpattern=e.oneTiData.opcreferencesuffixpattern.slice(0,-1),o.projectSave("onetime",e.oneTiData).then(function(t){r.custom("success","Onetime Successfully Saved","Onetime"),e.onetimeConfig(),a.complete()},function(e){r.custom("error","Error Occured While Saving","Onetime!"),a.complete()})},e.scheduleConfig=function(){a.start(),e.clearaffixes(),o.config("schedule").then(function(t){e.scheData=i.get(t),e.prefixesAndSuffixesFromRemote(i.get(t).screferenceprefixpattern,!0),e.prefixesAndSuffixesFromRemote(i.get(t).screferencesuffixpattern,!1),e.makePcity(),a.complete();var n=0;angular.forEach(e.periodCity,function(t){t.value==e.scheData.scperiodicityid&&(n=1,e.scheData.scperiodicityid=t.value)}),0==n&&(e.scheData.scperiodicityid=0)},function(e){a.complete()})},e.saveSchedule=function(){a.start(),e.scheData.screferenceprefixpattern="",angular.forEach(e.selectedPrefs,function(t){e.scheData.screferenceprefixpattern+=t.value+","}),e.scheData.screferenceprefixpattern=e.scheData.screferenceprefixpattern.slice(0,-1),e.scheData.screferencesuffixpattern="",angular.forEach(e.selectedSufs,function(t){e.scheData.screferencesuffixpattern+=t.value+","}),e.scheData.screferencesuffixpattern=e.scheData.screferencesuffixpattern.slice(0,-1),o.save("schedule",e.scheData).then(function(t){r.custom("success","Schedule Successfully Saved","Schedule"),e.scheduleConfig(),a.complete()},function(e){r.custom("error","Error Occured While Saving","Schedule!"),a.complete()})},e.makePattern=function(t,n,o,i,r,a){e.zeroFill(t,n,o),$("#previewModal").modal("show");var l=[],u=[];angular.forEach(e.selectedPrefs,function(e){switch(e.value){case"day1":l.push(c.getDate());break;case"day2":c.getDate()<10?l.push("0"+c.getDate()):l.push(c.getDate());break;case"month1":l.push(c.getMonth()+1);break;case"month2":("0"+(c.getMonth()+1)).slice(-2)<10?l.push(("0"+(c.getMonth()+1)).slice(-2)):l.push(c.getMonth()+1);break;case"year2":l.push(c.getFullYear().toString().slice(-2));break;case"year4":l.push(c.getFullYear());break;case"delimeter":l.push($("#"+r).val());break;case"custom":l.push($("#"+i).val());break;default:l.push(e.value)}}),angular.forEach(e.selectedSufs,function(e){switch(e.value){case"day1":u.push(c.getDate());break;case"day2":c.getDate()<10?u.push("0"+c.getDate()):u.push(c.getDate());break;case"month1":u.push(c.getMonth()+1);break;case"month2":("0"+(c.getMonth()+1)).slice(-2)<10?u.push(("0"+(c.getMonth()+1)).slice(-2)):u.push(c.getMonth()+1);break;case"year2":u.push(c.getFullYear().toString().slice(-2));break;case"year4":u.push(c.getFullYear());break;case"delimeter":u.push($("#"+r).val());break;case"custom":u.push($("#"+a).val());break;default:u.push(e.value)}}),e.patternPreview=l.join("")+s+u.join("")}}]),app.factory("Config",["$http",function(e){return{get:function(t){return e.get("sim/pms/config/"+t+"/row")},project:function(t){return e.get("sim/pms/config/project/"+t+"/row")},config:function(t){return e.get("sim/pms/config/"+t+"/row")},projectSave:function(t,n){return e({method:"POST",url:"sim/pms/config/project/"+t,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},save:function(t,n){return e({method:"POST",url:"sim/pms/config/"+t,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},searchTags:function(t){return e.get("sim/hm/branch/ddmenu")}}}]),app.controller("notificationCtrl",["$scope","$http","$log","notification","Data","notify","cfpLoadingBar","$timeout","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c,l){e.formData={notification:[]},e.arr=[],o.getNotification().then(function(t){e.notification=i.get(t),console.log(e.notification),angular.element(document).ready(function(){$(".chk1").hide()}),angular.forEach(e.notification,function(t){t.unison&&e.formData.notification.push({unnotificationid:t.nnotificationid,unbase:t.base,unison:t.unison})})},function(e){}),e.dataas=!1,e.putkey=function(t){e.data="baseinput"+t,e.data=!0,$(".baseinput"+t).hide()},e.enabled=!1,e.onOff=!0,e.yesNo=!0,e.valuedata=!1,e.changedata=function(t,n,o){if($(".baseoutput"+n).hide(),e.unison=o,e.base=t.nnotification.includes("<base>"),"1"==o&&1==e.base?$(".baseoutput"+n).show():$(".baseoutput"+n).hide(),0==e.base){for(i=0;i<e.formData.notification.length;i++)e.formData.notification[i].unnotificationid==t.nnotificationid&&e.formData.notification.splice(i,1);e.formData.notification.push({unnotificationid:t.nnotificationid,unbase:0,unison:e.unison})}if("0"==o){console.log(t.nnotificationid),console.log(e.formData);for(var i=0;i<e.formData.notification.length;i++)e.formData.notification[i].unnotificationid==t.nnotificationid&&e.formData.notification.splice(i,1)}},e.makeContainer=function(t,n,o){for(var i=0;i<e.formData.notification.length;i++)e.formData.notification[i].unnotificationid==n.nnotificationid&&e.formData.notification.splice(i,1);e.formData.notification.push({unnotificationid:n.nnotificationid,unbase:t,unison:o})},e.save=function(){console.log(e.formData),o.save(e.formData).then(function(t){console.log(i.get(t)),i.get(t).success&&(console.log(i.get(t)),a.complete(),$("#myModal").modal("hide"),r.custom("success","user Successfully Saved!","user"),o.getNotification().then(function(t){e.notifcation=i.get(t),console.log(e.notifcation)},function(e){}))},function(e){a.complete()})}}]),app.factory("notification",["$http",function(e){return{getNotification:function(){return e.get("sim/sap/notification")},save:function(t){return e({method:"POST",url:"sim/sap/notification",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})}}}]),app.controller("roleCtrl",["$scope","$http","$log","Role","Data","notify","cfpLoadingBar","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c){e.formData={rroleid:0,modules:[]},a.start(),o.get().then(function(t){e.roles=i.get(t),e.doPagination(e.roles),a.complete()},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.permissions=[{name:"access denid",permissionid:0},{name:"Read",permissionid:1},{name:"Write",permissionid:2},{name:"Full Controlled",permissionid:3}],o.GetModule().then(function(t){e.modules=i.get(t)},function(e){}),e.clearform=function(){e.clear()},e.saveUserRole=function(){a.start(),o.save(e.formData).then(function(t){i.get(t).success?(e.formData={rroleid:0,modules:[]},a.complete(),$("#myModal").modal("hide"),r.custom("success","User Role Successfully Saved!","user"),o.get().then(function(t){e.roles=i.get(t),e.doPagination(e.roles)},function(e){})):(a.complete(),"UQ_RoleName"==i.get(t).message?r.custom("error","Role  Name Already Exists!","Role"):r.custom("error","Something went wrong!","Role"))},function(e){a.complete()})},e.clear=function(){$(".clr").prop("selected",!1),e.formData={rroleid:0,modules:[]}},e.EditRole=function(t){e.clear(),a.start(),o.EditData(t).then(function(t){e.formData=i.get(t),a.complete(),$("#myModal").modal("show")},function(e){a.complete()},function(e){}),o.EditModule(t).then(function(t){e.formData.modules=i.get(t),angular.forEach(i.get(t),function(e){angular.element(document).ready(function(){$(".data"+e.rmmoduleid).val(e.rmpermissionid)})})},function(e){})},e.DeleteRole=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This user role?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.DestroyRole(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","User role Successfully Deleted","success"),o.get().then(function(t){e.roles=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},e.update=function(t,n){isNaN(t)||(e.formData.rroleid,e.formData.modules.push({rmrolemoduleid:"0",rmroleid:e.formData.rroleid,rmmoduleid:n,rmpermissionid:t}))}}]),app.factory("Role",["$http",function(e){return{get:function(){return e.get("sim/sap/role")},save:function(t){return e({method:"POST",url:"sim/sap/role",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},EditData:function(t){return e.get("sim/sap/role/"+t)},DestroyRole:function(t){return e({method:"POST",url:"sim/sap/role/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},GetModule:function(){return e.get("sim/sap/modules")},EditModule:function(t){return e.get("sim/sap/role/modules/"+t)}}}]),app.controller("templateCtrl",["$scope","$http","$log","Template","Data","notify","cfpLoadingBar","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c){e.tempData={qtquotationtemplateid:0},a.start(),o.get("quotation").then(function(t){a.complete(),e.quotations=i.get(t),e.doPagination(e.quotations)},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.tempClear=function(){e.tempData={qtquotationtemplateid:0},e.ctData={ctcontracttemplateid:0},e.invData={itinvoicetemplateid:0}},e.saveQuotation=function(){a.start(),o.save("quotation",e.tempData).then(function(t){"UQ_QuotationTemplateName"==i.get(t).message?(a.complete(),r.custom("error","Template Already Exists!","Quotation")):(e.tempClear(),a.complete(),$("#qtModal").modal("hide"),r.custom("success","Quotation Successfully Added!","Quotation!"),o.get("quotation").then(function(t){e.quotations=i.get(t),e.doPagination(e.quotations)},function(e){}))},function(e){a.complete(),r.custom("error","Error Occured While Saving!","Quotation!")})},e.editRow=function(t){a.start(),o.show("quotation",t).then(function(t){e.tempData=i.get(t),a.complete(),$("#qtModal").modal("show")},function(e){})},e.deleteQuotation=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Customer?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy("quotation",t).then(function(t){r.custom("success","Quotation Successfully Deleted!","Quotation!"),swal("Deleted!","Quotation Successfully Deleted!","success"),o.get("quotation").then(function(t){e.quotations=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},e.ctData={ctcontracttemplateid:0},o.get("contract").then(function(t){e.contracts=i.get(t),e.doPagination(e.contracts)},function(e){}),e.saveContract=function(){a.start(),o.save("contract",e.ctData).then(function(t){"UQ_ContractTemplateName"==i.get(t).message?(a.complete(),r.custom("error","Template Already Exists!","Contract")):(e.tempClear(),a.complete(),$("#ctModal").modal("hide"),r.custom("success","Contract Successfully Added!","Contract!"),o.get("contract").then(function(t){e.contracts=i.get(t),e.doPagination(e.contracts)},function(e){}))},function(e){a.complete(),r.custom("error","Error Occured While Saving!","Contract!")})},e.editContract=function(t){a.complete(),o.show("contract",t).then(function(t){e.ctData=i.get(t),a.complete(),$("#ctModal").modal("show")},function(e){a.complete()})},e.deleteContract=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Customer?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy("contract",t).then(function(t){r.custom("success","Contract Successfully Deleted!","Contract!"),swal("Deleted!","Contract Successfully Deleted!","success"),o.get("contract").then(function(t){e.contracts=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},e.invData={itinvoicetemplateid:0},o.get("invoice").then(function(t){e.invoices=i.get(t)},function(e){}),e.saveInvoice=function(){a.start(),o.save("invoice",e.invData).then(function(t){"UQ_InvoiceTemplateName"==i.get(t).message?(a.complete(),r.custom("error","InvoiceTemplateName Already Exists!","Invoice")):(e.tempClear(),a.complete(),$("#inModal").modal("hide"),r.custom("success","Invoice Successfully Added!","Invoice!"),o.get("invoice").then(function(t){e.invoices=i.get(t)},function(e){}))},function(e){a.complete(),r.custom("error","Error Occured While Saving!","Invoice!")})},e.editInvoice=function(t){a.start(),o.show("invoice",t).then(function(t){e.invData=i.get(t),a.complete(),$("#inModal").modal("show")},function(e){a.complete()})},e.deleteInvoice=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Customer?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy("invoice",t).then(function(t){r.custom("success","Invoice Successfully Deleted!","Invoice!"),swal("Deleted!","Invoice Successfully Deleted!","success"),o.get("invoice").then(function(t){e.invoices=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})}}]),app.factory("Template",["$http",function(e){return{get:function(t){return e.get("sim/pms/template/"+t)},show:function(t,n){return e.get("sim/pms/template/"+t+"/"+n)},save:function(t,n){return e({method:"POST",url:"sim/pms/template/"+t,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},destroy:function(t,n){return e({method:"POST",url:"sim/pms/template/"+t+"/"+n,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},test:function(e){return e},DropDown:function(){return e.get("sim/hr/employee/ddmenu")},Departments:function(){return e.get("sim/hr/department/ddmenu")}}}]),app.controller("trashCtrl",["$scope","$http","$log","Trash","Data","notify","cfpLoadingBar",function(e,t,n,o,i,r,a){a.start(),o.getTrashedBranches().then(function(t){e.branches=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Branches","Branches")}),e.restoreBranch=function(t){a.start(),o.restoreBranch(t).then(function(t){a.complete(),o.getTrashedBranches().then(function(t){e.branches=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Branches!","Branches")})},function(e){a.complete(),r.custom("error","Can't Restore This Branch!","Branches")})},e.removeBranch=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Branch?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.removeBranch(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","Branch Successfully Deleted","success"),o.getTrashedBranches().then(function(t){e.branches=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},a.start(),o.getTrasheddept().then(function(t){e.department=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Department","Department")}),e.restoreDept=function(t){a.start(),o.restoreDept(t).then(function(t){a.complete(),o.getTrasheddept().then(function(t){e.department=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Department!","Department")})},function(e){a.complete(),r.custom("error","Can't Restore This Department!","Department")})},e.removeDeptmnt=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Department?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.removeDept(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","Department Successfully Deleted","success"),o.getTrasheddept().then(function(t){e.department=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},a.start(),o.getTrashedemployee().then(function(t){e.employees=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Employee","Employee")}),e.restoreEmployee=function(t){a.start(),o.restoreEmpolee(t).then(function(t){a.complete(),o.getTrashedemployee().then(function(t){e.employees=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Employee!","Employee")})},function(e){a.complete(),r.custom("error","Can't Restore This Employee!","Employee")})},e.removeEmployee=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Employee?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.removeemployee(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","Employee Successfully Deleted","success"),o.getTrashedemployee().then(function(t){e.employees=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},a.start(),o.getTrashedesignation().then(function(t){e.designations=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Designation","Designation")}),e.restoreDesignation=function(t){a.start(),o.restoreDesignation(t).then(function(t){a.complete(),o.getTrashedesignation().then(function(t){e.designations=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Designation!","Designation")})},function(e){a.complete(),r.custom("error","Can't Restore This Designation!","Designation")})},e.removeDesignation=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This designations?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.removeDesignation(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","designations Successfully Deleted","success"),o.getTrashedesignation().then(function(t){e.designations=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},a.start(),o.getTrasheservice().then(function(t){e.service=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Service","Service")}),e.restoreService=function(t){a.start(),o.restoreservice(t).then(function(t){a.complete(),o.getTrasheservice().then(function(t){e.service=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Service!","Service")})},function(e){a.complete(),r.custom("error","Can't Restore This Service!","Service")})},e.removeService=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This service?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.removeservice(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","service Successfully Deleted","success"),o.getTrasheservice().then(function(t){e.service=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},a.start(),o.getTrasheCustomer().then(function(t){e.customers=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Customers","Customers")}),e.restoreCustomer=function(t){a.start(),o.restorecustomer(t).then(function(t){a.complete(),o.getTrasheCustomer().then(function(t){e.customers=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Customers!","Customers")})},function(e){a.complete(),r.custom("error","Can't Restore This Customers!","Customers")})},e.removeCustomer=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This customers?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.removecustomer(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","customers Successfully Deleted","success"),o.getTrasheCustomer().then(function(t){e.customers=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},a.start(),o.getTrasheJob().then(function(t){e.jobsite=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Jobsite","Jobsite")}),e.restoreJobSite=function(t){a.start(),o.restoreJob(t).then(function(t){a.complete(),o.getTrasheJob().then(function(t){e.jobsite=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch Jobsite!","Jobsite")})},function(e){a.complete(),r.custom("error","Can't Restore This jobsite!","jobsite")})},e.removeJobSite=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This jobsite?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.removejob(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","jobsite Successfully Deleted","success"),o.getTrasheJob().then(function(t){e.jobsite=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},a.start(),o.getTrasheproject().then(function(t){e.projects=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch projects","projects")}),e.restoreproject=function(t){a.start(),o.restoreproject(t).then(function(t){o.getTrasheproject().then(function(t){e.projects=i.get(t)},function(e){r.custom("error","Can't Fetch projects!","projects")})},function(e){r.custom("error","Can't Restore This projects!","projects")})},e.removeproject=function(t){a.start(),swal({title:"Reason!",text:"Write a Reason to Remove:",type:"input",showCancelButton:!0,closeOnConfirm:!0,animation:"slide-from-top",inputPlaceholder:"Write Something"},function(n){return!1===n?(a.complete(),!1):""===n?(a.complete(),swal.showInputError("You need to write something!"),!1):void o.removeproject(t,n).then(function(t){a.complete(),r.custom("success","project Removed!","project"),o.getTrasheproject().then(function(t){e.projects=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch project","project")})},function(e){a.complete(),r.custom("error","Can't Remove This project!","project")})})},a.start(),o.getTrasheinvoice().then(function(t){e.invoice=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch invoice","invoice")}),e.restoreinvoices=function(t){a.start(),o.restoreinvoice(t).then(function(t){a.complete(),o.getTrasheinvoice().then(function(t){e.invoice=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch invoice!","invoice")})},function(e){a.complete(),r.custom("error","Can't Restore This invoice!","invoice")})},e.removeinvoices=function(t){a.start(),swal({title:"Reason!",text:"Write a Reason to Remove:",type:"input",showCancelButton:!0,closeOnConfirm:!0,animation:"slide-from-top",inputPlaceholder:"Write Something"},function(n){return!1===n?(a.complete(),!1):""===n?(a.complete(),swal.showInputError("You need to write something!"),!1):void o.removeinvoice(t,n).then(function(t){a.complete(),r.custom("success","invoice Removed!","invoice"),o.getTrasheinvoice().then(function(t){e.invoice=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch invoice","invoice")})},function(e){a.complete(),r.custom("error","Can't Remove This invoice!","invoice")})})},a.start(),o.getquotation().then(function(t){e.quotations=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch quotation","quotation")}),e.restorequotation=function(t){a.start(),o.restorequotation(t).then(function(t){a.complete(),o.getquotation().then(function(t){e.quotations=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch quotation!","quotation")})},function(e){a.complete(),r.custom("error","Can't Restore This quotation!","quotation")})},e.removequotation=function(t){a.start(),swal({title:"Reason!",text:"Write a Reason to Remove:",type:"input",showCancelButton:!0,closeOnConfirm:!0,animation:"slide-from-top",inputPlaceholder:"Write Something"},function(n){return!1===n?(a.complete(),!1):""===n?(a.complete(),swal.showInputError("You need to write something!"),!1):void o.removequotation(t,n).then(function(t){a.complete(),r.custom("success","quotations Removed!","quotations"),o.getquotation().then(function(t){e.quotations=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch quotations","quotations")})},function(e){a.complete(),r.custom("error","Can't Remove This quotations!","quotations")})})},a.start(),o.getreminder().then(function(t){e.reminders=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch reminder","reminder")}),e.restorereminder=function(t){a.start(),o.restorereminder(t).then(function(t){a.complete(),o.getreminder().then(function(t){e.reminders=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch reminder!","reminder")})},function(e){a.complete(),r.custom("error","Can't Restore This reminder!","reminder")})},e.removereminder=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This reminders?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.removereminder(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","reminders Successfully Deleted","success"),o.getreminder().then(function(t){e.reminders=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},a.start(),o.getcontact().then(function(t){e.contacts=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch contact","contact")}),e.restorecontact=function(t){a.start(),o.restorecontact(t).then(function(t){a.complete(),o.getcontact().then(function(t){e.contacts=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch contact!","contact")})},function(e){a.complete(),r.custom("error","Can't Restore This contact!","contact")})},e.removecontact=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This contacts?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.removecontact(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","contacts Successfully Deleted","success"),o.getcontact().then(function(t){e.contacts=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},a.start(),o.getrole().then(function(t){e.roles=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch role","role")}),e.restorerole=function(t){a.start(),o.restorerole(t).then(function(t){a.complete(),o.getrole().then(function(t){e.roles=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch role!","role")})},function(e){a.complete(),r.custom("error","Can't Restore This role!","role")})},e.removerole=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This roles?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.removerole(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","roles Successfully Deleted","success"),o.getrole().then(function(t){e.roles=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},a.start(),o.gettemplate().then(function(t){console.log(i.get(t)),e.templates=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch template","template")}),e.restoretemplate=function(t){a.start(),o.restoretemplate(t).then(function(t){a.complete(),o.gettemplate().then(function(t){e.templates=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch template!","template")})},function(e){a.complete(),r.custom("error","Can't Restore This template!","template")})},e.removetemplate=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This templates?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.removetemplate(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","templates Successfully Deleted","success"),o.gettemplate().then(function(t){e.templates=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},a.start(),o.getschedule().then(function(t){e.schedules=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch schedule","schedule")}),e.restoreschedule=function(t){a.start(),o.restoreschedule(t).then(function(t){a.complete(),o.getschedule().then(function(t){e.schedules=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch schedule!","schedule")})},function(e){a.complete(),r.custom("error","Can't Restore This schedule!","schedule")})},e.removeschedule=function(t){a.start(),swal({title:"Reason!",text:"Write a Reason to Remove:",type:"input",showCancelButton:!0,closeOnConfirm:!0,animation:"slide-from-top",inputPlaceholder:"Write Something"},function(n){return!1===n?(a.complete(),!1):""===n?(a.complete(),swal.showInputError("You need to write something!"),!1):void o.removeschedule(t,n).then(function(t){a.complete(),r.custom("success","template Removed!","template"),o.getschedule().then(function(t){e.schedules=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch schedule","schedule")})},function(e){a.complete(),r.custom("error","Can't Remove This schedule!","schedule")})})},a.start(),o.getexpense().then(function(t){e.expsheets=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch expense","expense")}),e.restoreexpense=function(t){a.start(),o.restoreexpense(t).then(function(t){a.complete(),o.getexpense().then(function(t){e.expsheets=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch expense!","expense")})},function(e){a.complete(),r.custom("error","Can't Restore This expense!","expense")})},e.removeexpense=function(t){a.start(),swal({title:"Reason!",text:"Write a Reason to Remove:",type:"input",showCancelButton:!0,closeOnConfirm:!0,animation:"slide-from-top",inputPlaceholder:"Write Something"},function(n){return!1===n?(a.complete(),!1):""===n?(a.complete(),swal.showInputError("You need to write something!"),!1):void o.removeexpense(t,n).then(function(t){a.complete(),r.custom("success","template Removed!","template"),o.getexpense().then(function(t){e.expsheets=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch expense","expense")})},function(e){a.complete(),r.custom("error","Can't Remove This expense!","expense")})})},a.start(),o.getjobsheet().then(function(t){e.jobsheet=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch jobsheet","role")}),e.restorejobsheet=function(t){a.start(),o.restorejobsheet(t).then(function(t){a.complete(),o.getjobsheet().then(function(t){e.jobsheet=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch jobsheet!","jobsheet")})},function(e){a.complete(),r.custom("error","Can't Restore This jobsheet!","jobsheet")})},e.removejobsheet=function(t){a.start(),swal({title:"Reason!",text:"Write a Reason to Remove:",type:"input",showCancelButton:!0,closeOnConfirm:!0,animation:"slide-from-top",inputPlaceholder:"Write Something"},function(n){return!1===n?(a.complete(),!1):""===n?(a.complete(),swal.showInputError("You need to write something!"),!1):void o.removejobsheet(t,n).then(function(t){a.complete(),r.custom("success","jobsheet Removed!","jobsheet"),o.getjobsheet().then(function(t){e.jobsheet=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch jobsheet","jobsheet")})},function(e){a.complete(),r.custom("error","Can't Remove This jobsheet!","jobsheet")})})},a.start(),o.getcontract().then(function(t){e.contracts=i.get(t),console.log(e.contracts),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch contracts","contracts")}),e.restorecotract=function(t){a.start(),o.restorecontract(t).then(function(t){a.complete(),o.getcontract().then(function(t){e.contracts=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch contracts!","contracts")})},function(e){a.complete(),r.custom("error","Can't Restore This contracts!","contracts")})},e.removecontract=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This contracts?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.removecontract(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","contracts Successfully Deleted","success"),o.getcontract().then(function(t){e.contracts=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},a.start(),o.getTinvoice().then(function(t){e.invoicesdata=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch invoices","invoices")}),e.restoreinvc=function(t){a.start(),o.restoreTinvoice(t).then(function(t){a.complete(),o.getTinvoice().then(function(t){e.invoicesdata=i.get(t),a.complete()},function(e){a.complete(),r.custom("error","Can't Fetch invoices!","invoices")})},function(e){a.complete(),r.custom("error","Can't Restore This invoices!","invoices")})},e.removeinvc=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This invoice?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.removeTinvoice(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","invoice Successfully Deleted","success"),o.getTinvoice().then(function(t){e.invoicesdata=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})}}]),app.factory("Trash",["$http",function(e){return{get:function(){},getTrashedBranches:function(){return e.get("sim/hm/branch/trashedall")},restoreBranch:function(t){return e.post("sim/hm/branch/restore/"+t)},removeBranch:function(t,n){return e.post("sim/hm/branch/remove/"+t+"/"+n)},getTrasheddept:function(){return e.get("sim/hm/department/trashedall")},restoreDept:function(t){return e.post("sim/hm/department/restore/"+t)},removeDept:function(t,n){return e.post("sim/hm/department/remove/"+t+"/"+n)},getTrashedemployee:function(){return e.get("sim/hm/employee/trashedall")},restoreEmpolee:function(t){return e.post("sim/hm/employee/restore/"+t)},removeemployee:function(t,n){return e.post("sim/hm/employee/remove/"+t+"/"+n)},getTrashedesignation:function(){return e.get("sim/hm/designation/trashedall")},restoreDesignation:function(t){return e.post("sim/hm/designation/restore/"+t)},removeDesignation:function(t,n){return e.post("sim/hm/designation/remove/"+t+"/"+n)},getTrasheservice:function(){return e.get("sim/sm/service/trashedall")},restoreservice:function(t){return e.post("sim/sm/service/restore/"+t)},removeservice:function(t,n){return e.post("sim/sm/service/remove/"+t+"/"+n)},getTrasheCustomer:function(){return e.get("sim/sm/customer/trashedall")},restorecustomer:function(t){return e.post("sim/sm/customer/restore/"+t)},removecustomer:function(t,n){return e.post("sim/sm/customer/remove/"+t+"/"+n)},getTrasheJob:function(){return e.get("sim/sm/jobsite/trashedall")},restoreJob:function(t){return e.post("sim/sm/jobsite/restore/"+t)},removejob:function(t,n){return e.post("sim/sm/jobsite/remove/"+t+"/"+n)},getTrasheproject:function(){return e.get("sim/pm/project/trashedall")},restoreproject:function(t){return e.post("sim/pm/project/restore/"+t)},removeproject:function(t,n){return e.post("sim/pm/project/remove/"+t+"/"+n)},getTrasheinvoice:function(){return e.get("sim/sma/invoice/trashedall")},restoreinvoice:function(t){return e.post("sim/sma/invoice/restore/"+t)},removeinvoice:function(t,n){return e.post("sim/sma/invoice/remove/"+t+"/"+n)},getquotation:function(){return e.get("sim/pm/quotation/trashedall")},restorequotation:function(t){return e.post("sim/pm/quotation/restore/"+t)},removequotation:function(t,n){return e.post("sim/pm/quotation/remove/"+t+"/"+n)},getreminder:function(){return e.get("sim/sut/reminder/trashedall")},restorereminder:function(t){return e.post("sim/sut/reminder/restore/"+t)},removereminder:function(t,n){return e.post("sim/sut/reminder/remove/"+t+"/"+n)},getcontact:function(){return e.get("sim/sut/contactbook/trashedall")},restorecontact:function(t){return e.post("sim/sut/contactbook/restore/"+t)},removecontact:function(t,n){return e.post("sim/sut/contactbook/remove/"+t+"/"+n)},getrole:function(){return e.get("sim/sap/role/trashedall")},restorerole:function(t){return e.post("sim/sap/role/restore/"+t)},removerole:function(t){return e.post("sim/sap/role/remove/"+t)},gettemplate:function(){return e.get("sim/pms/template/quotation/trashedall")},restoretemplate:function(t){return e.post("sim/pms/template/quotation/restore/"+t)},removetemplate:function(t,n){return e.post("sim/pms/template/quotation/remove/"+t+"/"+n)},getschedule:function(){return e.get("sim/pm/schedule/trashedall")},restoreschedule:function(t){return e.post("sim/pm/schedule/restore/"+t)},removeschedule:function(t,n){return e.post("sim/pm/schedule/remove/"+t+"/"+n)},getexpense:function(){return e.get("sim/pm/expense/trashedall")},restoreexpense:function(t){return e.post("sim/pm/expense/restore/"+t)},removeexpense:function(t,n){return e.post("sim/pm/expense/remove/"+t+"/"+n)},getjobsheet:function(){return e.get("sim/pm/sheet/trashedall")},restorejobsheet:function(t){return e.post("sim/pm/sheet/restore/"+t)},removejobsheet:function(t,n){return e.post("sim/pm/sheet/remove/"+t+"/"+n)},getcontract:function(){return e.get("sim/pms/template/contract/trashedall")},restorecontract:function(t){return e.post("sim/pms/template/contract/restore/"+t)},removecontract:function(t,n){return e.post("sim/pms/template/contract/remove/"+t+"/"+n)},getTinvoice:function(){return e.get("sim/pms/template/invoice/trashedall")},restoreTinvoice:function(t){return e.post("sim/pms/template/invoice/restore/"+t)},removeTinvoice:function(t,n){return e.post("sim/pms/template/invoice/remove/"+t+"/"+n)}}}]),app.controller("UserCtrl",["$scope","$http","$log","User","Data","notify","cfpLoadingBar","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c){e.formData={sucategory:"User",suuserid:0},a.start(),o.get().then(function(t){e.users=i.get(t),e.doPagination(e.users),a.complete()},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},a.start(),o.GetEmply().then(function(t){e.employeesdata=i.get(t),a.complete()},function(e){a.complete()}),o.Getroledata().then(function(t){e.rolesbox=i.get(t)},function(e){}),e.valuedata="select",e.update=function(t){e.formData.sucategory="select"==t?"User":"employee"},e.saverole=function(t){e.formData.suroleid=t},e.saveUser=function(){a.start(),o.save(e.formData).then(function(t){i.get(t).success?(e.formData={suuserid:0,sucategory:"User"},a.complete(),$("#myModal").modal("hide"),r.custom("success","user Successfully Saved!","user"),o.get().then(function(t){e.users=i.get(t),e.doPagination(e.users)},function(e){})):(a.complete(),"Invited_Registered_User"==i.get(t).message?r.custom("error","User  Already Registered!","User"):"UQ_UserCode"==i.get(t).message?r.custom("error","User Code Already Exists!","UserCode"):"UQ_Email_Active"==i.get(t).message?r.custom("error","User  Already Invited!","User"):r.custom("error","Something Wrong!","User"))},function(e){document.getElementById("email").disabled=!1,a.complete()})},e.editUser=function(t){1==e.formData.suusertypeid&&(e.typeid=!0),a.start(),o.editdata(t).then(function(t){e.formData=i.get(t),e.formData.suemail?document.getElementById("email").disabled=!0:document.getElementById("email").disabled=!1,a.complete(),$("#myModal").modal("show")},function(e){a.complete()})},e.deleteUser=function(t){swal({title:"Are you sure?",text:"Do You Want To Terminate This user?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.terminate(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","User Successfully Terminated","success"),o.get().then(function(t){e.users=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},e.permissions=[{name:"access denid",permissionid:"0"},{name:"Read",permissionid:"1"},{name:"Write",permissionid:"2"},{name:"Full Controlled",permissionid:"3"}],angular.element(document).ready(function(){$(document).on("change",".permission",function(){if(this.checked)e.formData.suuserid,e.formData.permission.push({pid:"0",perid:e.formData.suuserid,permissionid:$(this).data("id")});else for(var t=0;t<e.permission.length;t++)e.formData.permission[t].permissionid==$(this).data("id")&&e.formData.permission.splice(t,1)})}),e.clear=function(){$(".module").prop("checked",!1),e.formData={suuserid:0,sucategory:"User"},document.getElementById("email").disabled=!1},e.clearForm=function(){e.clear()}}]),app.factory("User",["$http",function(e){return{get:function(){return e.get("sim/sap/user")},save:function(t){return e({method:"POST",url:"sim/sap/user",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},editdata:function(t){return e.get("sim/sap/user/"+t)},terminate:function(t){return e({method:"POST",url:"sim/sap/user/terminate/"+t,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},GetEmply:function(){return e.get("sim/hm/employee/ddmenu")},Getroledata:function(){return e.get("sim/sap/role")}}}]),app.controller("reportCtrl",["$http","$scope","$log","notify","Report","Data","DTOptionsBuilder","DTColumnBuilder",function(e,t,n,o,i,r,a,s){t.dtOptions=a.fromSource("sim/hm/employee/report").withDOM("<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>tp").withButtons([{extend:"copy",className:"btn-sm"},{extend:"csv",title:"ExampleFile",className:"btn-sm"},{extend:"pdf",title:"ExampleFile",className:"btn-sm"},{extend:"print",className:"btn-sm"}]),t.dtColumns=[s.newColumn("heemployeecode").withTitle("Project Reference"),s.newColumn("hebasicsalary").withTitle("Job Reference"),s.newColumn("heofficialcontact").withTitle("Contact"),s.newColumn("heofficialmail").withTitle("Email"),s.newColumn("hejoineddate").withTitle("Joined"),s.newColumn("hedob").withTitle("DOB"),s.newColumn("hegender").withTitle("Gender"),s.newColumn("hemaritalstatus").withTitle("Martial Status"),s.newColumn("hefathername").withTitle("Father Name"),s.newColumn("heemergencycontact").withTitle("Emergency Contact"),s.newColumn("hepersonalemail").withTitle("Personal Email"),s.newColumn("hepersonalcontact").withTitle("Personal Contact"),s.newColumn("branch").withTitle("Branch"),s.newColumn("department").withTitle("Department"),s.newColumn("supervisor").withTitle("Supervisor"),s.newColumn("nationality").withTitle("Nationality"),s.newColumn("employee").withTitle("Employee")]}]),app.factory("Report",["$http",function(e){return{get:function(t){return e.post("sim/pm/job/report")}}}]),app.controller("jobReportCtrl",["$scope","DTOptionsBuilder","DTColumnBuilder",function(e,t,n){e.dtOptions=t.fromSource("sim/pm/job/report").withDOM("<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>tp").withButtons([{extend:"copy",className:"btn-sm"},{extend:"csv",title:"ExampleFile",className:"btn-sm"},{extend:"pdf",title:"ExampleFile",className:"btn-sm"},{extend:"print",className:"btn-sm"}]),e.dtColumns=[n.newColumn("pprojectreference").withTitle("Project Reference"),n.newColumn("jjobreference").withTitle("Job Reference"),n.newColumn("customer").withTitle("Customer"),n.newColumn("service").withTitle("Service"),n.newColumn("jobsite").withTitle("Job Site"),n.newColumn("head").withTitle("Head"),n.newColumn("date").withTitle("Date"),n.newColumn("timein").withTitle("TimeIn"),n.newColumn("timeout").withTitle("TimeOut"),n.newColumn("branch").withTitle("Branch"),n.newColumn("servicedescription").withTitle("Service Descritpion"),n.newColumn("unit").withTitle("Unit"),n.newColumn("rate").withTitle("Rate"),n.newColumn("total").withTitle("Total"),n.newColumn("batchno").withTitle("Batch")]}]),app.controller("jobsheetCtrl",["$http","$scope","$log","notify","Report","Data","DTOptionsBuilder","DTColumnBuilder",function(e,t,n,o,i,r,a,s){t.dtOptions=a.fromSource("sim/pm/sheet/report").withDOM("<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>tp").withButtons([{extend:"copy",className:"btn-sm"},{extend:"csv",title:"ExampleFile",className:"btn-sm"},{extend:"pdf",title:"ExampleFile",className:"btn-sm"},{extend:"print",className:"btn-sm"}]),t.dtColumns=[s.newColumn("jstsheetreference").withTitle("Sheet Reference"),s.newColumn("jststartdate").withTitle("Start Date"),s.newColumn("jsttimein").withTitle("Timein"),s.newColumn("jsttimeout").withTitle("Timeout"),s.newColumn("jstenddate").withTitle("End Date")]}]),app.controller("projectReportCtrl",["$scope","DTOptionsBuilder","DTColumnBuilder",function(e,t,n){e.dtOptions=t.fromSource("sim/pm/project/report").withDOM("<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>tp").withButtons([{extend:"copy",className:"btn-sm"},{extend:"csv",title:"ExampleFile",className:"btn-sm"},{extend:"pdf",title:"ExampleFile",className:"btn-sm"},{extend:"print",className:"btn-sm"}]),e.dtColumns=[n.newColumn("qquotationreference").withTitle("Quotation Reference"),n.newColumn("qquoteddate").withTitle("Quoted Date"),n.newColumn("qvaliduntil").withTitle("Validity"),n.newColumn("qsubject").withTitle("Subject"),n.newColumn("qperiod").withTitle("Quotation Period"),n.newColumn("qtotal").withTitle("Total"),n.newColumn("qgrandtotal").withTitle("Grand Total"),n.newColumn("customer").withTitle("Customer"),n.newColumn("quotedby").withTitle("Quoted By"),n.newColumn("branch").withTitle("Branch"),n.newColumn("jobtype").withTitle("JobType"),n.newColumn("period").withTitle("Period"),n.newColumn("status").withTitle("Status")]}]),app.controller("quotationReportCtrl",["$scope","DTOptionsBuilder","DTColumnBuilder",function(e,t,n){e.dtOptions=t.fromSource("sim/pm/quotation/report").withDOM("<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>tp").withButtons([{extend:"copy",className:"btn-sm"},{extend:"csv",title:"ExampleFile",className:"btn-sm"},{extend:"pdf",title:"ExampleFile",className:"btn-sm"},{extend:"print",className:"btn-sm"}]),e.dtColumns=[n.newColumn("qquotationreference").withTitle("Quotation Reference"),n.newColumn("qquoteddate").withTitle("Quoted Date"),n.newColumn("qvaliduntil").withTitle("Validity"),n.newColumn("qsubject").withTitle("Subject"),n.newColumn("qperiod").withTitle("Quotation Period"),n.newColumn("qtotal").withTitle("Total"),n.newColumn("qgrandtotal").withTitle("Grand Total"),n.newColumn("customer").withTitle("Customer"),n.newColumn("quotedby").withTitle("Quoted By"),n.newColumn("branch").withTitle("Branch"),n.newColumn("jobtype").withTitle("JobType"),n.newColumn("period").withTitle("Period"),n.newColumn("status").withTitle("Status")]}]),app.controller("jobScheduleCtrl",["$scope","DTOptionsBuilder","DTColumnBuilder",function(e,t,n){e.dtOptions=t.fromSource("sim/pm/schedule/report").withDOM("<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>tp").withButtons([{extend:"copy",className:"btn-sm"},{extend:"csv",title:"ExampleFile",className:"btn-sm"},{extend:"pdf",title:"ExampleFile",className:"btn-sm"},{extend:"print",className:"btn-sm"}]),e.dtColumns=[n.newColumn("jshschedulereference").withTitle("Schedule Reference"),n.newColumn("jshdate").withTitle("Date"),n.newColumn("jshtimein").withTitle("TimeIn"),n.newColumn("jshtimeout").withTitle("TimeOut"),n.newColumn("head").withTitle("Head")]}]),app.controller("customerCtrl",["$scope","$http","$log","Customer","Data","notify","cfpLoadingBar","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c){e.attnData={},e.formData={cscustomerid:0,attentions:[]},a.start(),o.get().then(function(t){a.complete(),e.customers=i.get(t),e.doPagination(e.customers)},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.clearForm=function(){e.formData={cscustomerid:0,attentions:[]}},e.addAttentions=function(){""!=$("#attn").val()&&(e.formData.attentions.push({caattention:e.attnData.attn,cacustomerattentionid:0,caemail:e.attnData.email,cacontact:e.attnData.contact}),e.attnData={},$("#attn").focus())},e.editAttns=function(t){e.attnData.attn=e.formData.attentions[t].caattention,e.attnData.email=e.formData.attentions[t].caemail,e.attnData.contact=e.formData.attentions[t].cacontact},e.removeAttns=function(t){e.formData.attentions.splice(t,1)},e.submitCustomer=function(){a.start(),o.save(e.formData).then(function(t){i.get(t).success?(e.clearForm(),a.complete(),$("#myModal").modal("hide"),r.success("success","Customer Successfully Saved","Customer!"),o.get().then(function(t){e.customers=i.get(t),e.doPagination(e.customers)},function(e){n.info(e)})):(a.complete(),"UQ_CustomerCode"==i.get(t).message?r.custom("error","Customer Code Code Already Exists!","Customer"):r.custom("error","Something went wrong!","Customer"))},function(e){a.complete(),r.error("error","Error Occurred While Saving","Customer!")})},e.editRow=function(t){a.start();var n,r=0;o.show(t).then(function(t){e.formData=i.get(t),2==r?(e.formData.attentions=n,$("#myModal").modal("show"),a.complete()):r=1},function(e){}),o.getAttn(t).then(function(t){1==r?(e.formData.attentions=i.get(t),a.complete(),$("#myModal").modal("show")):(r=2,n=i.get(t))},function(e){})},e.deleteCustomer=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Customer?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","Customer Successfully Deleted","success"),o.get().then(function(t){e.customers=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},angular.element(document).ready(function(){$(document).on("click","#addAttn",function(){if(""==$("#attn").val())alert("Attention Name Cannot be NUll");else{var t=$("#attn").val(),n=$("#email").val(),o=$("#contact").val();e.formData.attentions.push({caattention:t,caemail:n,cacontact:o})}})})}]),app.factory("Customer",["$http",function(e){return{get:function(){return e.get("sim/sm/customer")},show:function(t){return e.get("sim/sm/customer/"+t)},save:function(t){return e({method:"POST",url:"sim/sm/customer",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},destroy:function(t){return e({method:"POST",url:"sim/sm/customer/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},getAttn:function(t){return e.get("sim/sm/customer/attention/getlist/"+t)},DropDown:function(){return e.get("sim/pm/employee/ddmenu")}}}]),app.controller("jobsiteCtrl",["$scope","$http","$log","Jobsite","Data","notify","cfpLoadingBar","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c){e.formData={jsjobsitesid:0};o.DropDown("country").then(function(t){e.countries=i.get(t)},function(e){}),o.DropDown("province").then(function(t){e.provinces=i.get(t)},function(e){}),a.start(),o.get().then(function(t){a.complete(),e.jobsites=i.get(t),e.doPagination(e.jobsites)},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.clearForm=function(){e.formData={jsjobsiteid:0},o.dfCountry().then(function(t){e.formData.jscountryid=t.data},function(e){})},e.submitJobsite=function(){a.start(),o.save(e.formData).then(function(t){e.formData={jsjobsiteid:0},a.complete(),$("#myModal").modal("hide"),r.custom("success","Jobsite Successfully Saved","Jobsite!"),o.get().then(function(t){e.jobsites=i.get(t),e.doPagination(e.jobsites)},function(e){n.info(e)})},function(e){a.complete(),r.custom("error","Error Occurred While Saving","Jobsite!")})},e.editRow=function(t){a.start(),o.show(t).then(function(t){e.formData=i.get(t),a.complete(),$("#myModal").modal("show")},function(e){})},e.deleteJobsite=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Jobsite?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","Jobsite Successfully Deleted","success"),o.get().then(function(t){e.jobsites=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})}}]),app.factory("Jobsite",["$http",function(e){return{get:function(){return e.get("sim/sm/jobsite")},show:function(t){return e.get("sim/sm/jobsite/"+t)},save:function(t){return e({method:"POST",url:"sim/sm/jobsite",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},dfCountry:function(){return e.get("static/countryid")},destroy:function(t){return e({method:"POST",url:"sim/sm/jobsite/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},test:function(e){return e},DropDown:function(t){return e.get("M@ster786/ddmenu/am/"+t+"/")}}}]),app.controller("serviceCtrl",["$scope","$http","$log","Service","Data","notify","cfpLoadingBar","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c){e.taskData={},e.formData={sserviceid:0,tasks:[]},e.editable=!1;a.start(),o.get().then(function(t){a.complete(),e.services=i.get(t),e.doPagination(e.services),console.log(e.services)},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.addTasks=function(){""!=$("#task").val()?(e.formData.tasks.push({sttask:e.taskData.task,stdescription:e.taskData.desc}),r.custom("success","Task Successfully Added","Task"),e.taskData={},$("#task").focus()):console.log("Task is Empty")},e.removeAttns=function(t){e.formData.tasks.splice(t,1)},o.Departments().then(function(t){e.Departments=i.get(t)},function(e){}),e.clearForm=function(){e.formData={sserviceid:0,tasks:[]}},e.submitService=function(){console.log(e.formData),a.start(),o.save(e.formData).then(function(t){console.log(i.get(t)),i.get(t).success?(e.formData={sserviceid:0,tasks:[]},a.complete(),$("#myModal").modal("hide"),r.custom("success","Service Successfully Saved!","Service!"),o.get().then(function(t){e.services=i.get(t),e.doPagination(e.services)},function(e){n.info(e)})):(a.complete(),"UQ_ServiceCode"==i.get(t).message?r.custom("error","Service Code Code Already Exists!","Service"):r.custom("error","Something went wrong!","Service"))},function(e){a.complete(),r.alert("error","Error Occurred While Saving","success")})},e.editRow=function(t){a.start();var n,r=0;o.show(t).then(function(t){e.formData=i.get(t),console.log(e.formData),2==r?(e.formData.tasks=n,$("#myModal").modal("show"),a.complete()):r=1},function(e){}),o.task(t).then(function(t){1==r?(e.formData.tasks=i.get(t),a.complete(),$("#myModal").modal("show")):(r=2,n=i.get(t))},function(e){})},e.deleteService=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Service?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy(t).then(function(t){$("#myModal").modal("hide"),swal("Deleted!","User role Successfully Deleted","success"),o.get().then(function(t){e.services=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})}}]),app.factory("Service",["$http",function(e){return{get:function(){return e.get("sim/sm/service")},show:function(t){return e.get("sim/sm/service/"+t)},save:function(t){return e({method:"POST",url:"sim/sm/service",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},destroy:function(t){return e({method:"POST",url:"sim/sm/service/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},task:function(t){return e.get("sim/sm/service/task/getlist/"+t)},Departments:function(t){return e.get("sim/hm/department/ddmenu")}}}]),app.controller("invoiceCtrl",["$scope","$http","$log","Invoice","Data","notify","cfpLoadingBar","AccessFactory","$state","$filter","genPDF",function(e,t,n,o,i,r,a,s,c,l,u){e.defaultData={services:[]},e.primeKey=0,e.formData={invinvoiceid:"0",invtax:0,jobs:[],invprojectid:0,invtotalamount:200},e.searchData={},e.listProjects=[],e.visible=!1,e.filterData={invstatusid:42},o.customer().then(function(t){e.customers=i.get(t)},function(e){}),o.templates().then(function(t){e.templates=i.get(t)},function(e){}),o.branch().then(function(t){e.branches=i.get(t)},function(e){}),o.users().then(function(t){e.users=i.get(t)},function(e){}),o.status().then(function(t){e.status=i.get(t)},function(e){}),o.jobtype().then(function(t){e.jobtype=i.get(t)},function(e){}),o.attentions().then(function(t){e.attentions=i.get(t)},function(e){}),o.jobsites().then(function(t){e.jobsites=i.get(t)},function(e){}),o.employees().then(function(t){e.employees=i.get(t)},function(e){}),a.start(),o.filterData(e.filterData).then(function(t){a.complete(),e.invoices=i.get(t),e.doPagination(e.invoices)},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.findProjects=function(){o.findProjects(e.searchData).then(function(t){e.listProjects=i.get(t)},function(e){})},e.getTotal=function(){for(var t=0,n=0;n<e.defaultData.services.length;n++){var o=e.defaultData.services[n];t+=Number(o.pdtotal)}e.formData.invtotalamount=t,0==e.editstatus&&(e.formData.invgrandtotal=t)},e.getTotal(),e.discountvalue=function(t){e.formData.invdiscount=t,e.dicoutdata=Number(e.formData.invtotalamount-e.formData.invdiscount),e.formData.invgrandtotal=e.dicoutdata},e.clearForm=function(){e.editstatus=!1,e.defaultData={services:[]},e.formData={invinvoiceid:0,invtax:0,jobs:[],invprojectid:0},e.searchData={},e.listProjects=[],e.filterData={invstatusid:42},o.dfConfig().then(function(t){e.formData.icinvoiceconfigurationid=i.get(t).icinvoiceconfigurationid,e.formData.icreferencetype=i.get(t).icreferencetype},function(e){})},e.printPdf=function(){},e.selectProject=function(t,n){e.defaultData=t,e.formData.invprojectid=t.pprojectid,o.findJobs("jobs",t.pprojectid).then(function(t){e.defaultData.services=i.get(t),angular.forEach(i.get(t),function(t){e.formData.jobs.push({jjobid:t.jjobid,juid:t.juid})})},function(e){})},e.searchList=function(){o.filterData(e.filterData).then(function(t){e.invoices=i.get(t)},function(e){})},e.saveInvoice=function(){isNaN(e.formData.invgrandtotal)&&(e.formData.invgrandtotal=e.formData.invtotalamount),"null"==e.formData.invdiscount&&(e.formData.invdiscount=0),o.save(e.formData).then(function(t){i.get(t).success?(r.custom("success","Invoice Successfully Saved!","Invoice!"),$("#Invoice").modal("hide"),o.filterData(e.filterData).then(function(t){e.invoices=i.get(t),e.doPagination(e.invoices)},function(e){})):"UQ_InvoiceReference"==i.get(t).message?r.custom("error","Invoice Reference Code Already Exists!","Invoice"):r.custom("error","Something went wrong!","Invoice"),$("#Invoice").modal("hide")},function(e){})},e.editRow=function(t){e.editstatus=!0,a.start(),o.show(t).then(function(t){a.complete(),$("#myModal").modal("show"),e.formData=i.get(t),e.formData={invcreatedon:e.formData.invcreatedon,invdate:e.formData.invdate,invdeletedon:e.formData.invdeletedon,invdiscount:e.formData.invdiscount,invgrandtotal:e.formData.invgrandtotal,invinvoiceconfigurationid:e.formData.invinvoiceconfigurationid,invinvoiceid:e.formData.invinvoiceid,invinvoicereference:e.formData.invinvoicereference,invinvoicetemplateid:e.formData.invinvoicetemplateid,invmodifiedon:e.formData.invmodifiedon,invprojectid:e.formData.invprojectid,invreceivedby:e.formData.invreceivedby,invreferencetype:e.formData.invreferencetype,invremarks:e.formData.invremarks,invstatusid:e.formData.invstatusid,invsubmittedbyemployeeid:e.formData.invsubmittedbyemployeeid,invtax:e.formData.invtax,invtotalamount:e.formData.invtotalamount,invuid:e.formData.invuid},e.defaultData.pcustomerid=i.get(t).customer,e.defaultData.pprojectreference=i.get(t).projectreference},function(e){a.complete()}),o.findJobs("detail",t).then(function(t){e.defaultData.services=i.get(t),e.getTotal()},function(e){})},e.deleteRow=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Invoice?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy(t).then(function(t){swal("Deleted!","ExpenseSheet Successfully Deleted","success"),o.filterData(e.filterData).then(function(t){e.invoices=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},e.exportData=function(t){var n={};o.exportInvoice(t).then(function(e){n=i.get(e)},function(e){}),o.exportInvoiceDetails(t).then(function(e){n.details=i.get(e)},function(e){}),o.company().then(function(t){n.company=i.get(t),e.makePdf(n)},function(e){})},e.makePdf=function(e){console.log(e);var t=[];t.push([{text:"Service",style:"headers",border:[!0,!0,!0,!0]},{text:"Description",style:"headers"},{text:"Unit",style:"headers"},{text:"Rate",style:"headers"},{text:"Total",style:"headers"}]),angular.forEach(e.details,function(e){e.qdfrequency;t.push([{text:e.pdserviceid,style:"tbodyRows",border:[!0,!0,!0,!0]},{text:e.pdservicedescription,style:"tbodyRows"},{text:e.pdunit.toString(),style:"tbodyRows"},{text:e.pdrate.toString(),style:"tbodyRows"},{text:e.pdtotal.toString(),style:"tbodyRows"}])}),t.push([{text:"Grand Total",alignment:"right",color:"#black",margin:[0,3,0,0],colSpan:4},{},{},{},{text:e.invgrandtotal,alignment:"center",margin:[0,3,0,0]}]);var n={content:[{columns:[{width:"*",text:""},{width:"*",text:"Invoice",alignment:"center",bold:!0,fontSize:20},{width:"*",text:""}],margin:[0,null==e.toppadding?100:parseInt(e.toppadding),0,0]},{columns:[{text:"From",bold:!0,fontSize:16},{text:"To",alignment:"right",bold:!0,fontSize:16}]},{columns:[{text:l("capitalize")(e.company.tcompanyname)+"\n"+l("capitalize")(e.company.taddress)+"\n"+e.company.tphone+"\n"+e.company.temail+"\n",fontSize:14},{text:l("capitalize")(e.customer)+"\n"+l("capitalize")(e.address)+"\n"+e.phone+"\n"+e.email,alignment:"right",fontSize:14}],margin:[0,0,0,10]},{table:{headerRows:1,widths:["*","*","*","*","*"],body:t},layout:"lightHorizontalLines",margin:[0,0,0,5]},{text:"Total Charged : "+e.invgrandtotal+" (AED) ("+l("toWords")(e.invgrandtotal)+")",margin:10},{columns:[{width:"*",text:"Name :"},{width:"*",text:""},{width:"*",text:"Name :"}]},{columns:[{width:"*",text:"Signature :"},{width:"*",text:""},{width:"*",text:"Signature :"}],margin:[0,0,0,null==e.bottompadding?100:parseInt(e.bottompadding)]}],styles:{headers:{alignment:"center",margin:[0,0,0,2],bold:!0},tbodyRows:{alignment:"center",margin:[0,3,0,3],italic:!0}}};u.print(n)}}]),app.factory("Invoice",["$http",function(e){return{get:function(){return e.get("sim/sma/invoice")},show:function(t){return e.get("sim/sma/invoice/"+t)},save:function(t){return e({method:"POST",url:"sim/sma/invoice",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},users:function(){return e.get("sim/sap/user/ddmenu")},status:function(){return e.get("sim/ddmenu/pm/status")},branch:function(){return e.get("sim/hm/branch/ddmenu")},destroy:function(t){return e({method:"POST",url:"sim/sma/invoice/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},customer:function(){return e.get("sim/sm/customer/ddmenu")},company:function(){return e.get("M@ster786/tenant/company/primary")},attentions:function(){return e.get("sim/sm/customer/attention/ddmenu")},jobsites:function(){return e.get("sim/sm/jobsite/ddmenu")},employees:function(){return e.get("sim/hm/employee/ddmenu")},service:function(){return e.get("sim/sm/service/ddmenu")},jobtype:function(){return e.get("sim/ddmenu/pm/jobtype")},findProjects:function(t){return e({method:"POST",url:"sim/pm/project/findlist",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},findJobs:function(t,n){return e.get("sim/sma/invoice/"+t+"/"+n)},filterData:function(t){return e({method:"POST",url:"sim/sma/invoice/findlist",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},templates:function(){return e.get("sim/pms/template/invoice")},dfConfig:function(){return e.get("sim/pms/config/invoice/list")},exportInvoice:function(t){return e.get("sim/sma/invoice/export/"+t)},exportInvoiceDetails:function(t){return e.get("sim/sma/invoice/detail/"+t)}}}]),app.controller("contactCtrl",["$scope","$http","$log","Contact","Data","notify","cfpLoadingBar","AccessFactory","$state",function(e,t,n,o,i,r,a,s,c){e.formData={cbcontactbookid:0},a.start(),o.get().then(function(t){a.complete(),e.contacts=i.get(t),e.doPagination(e.contacts)},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.clearForm=function(){e.formData={cbcontactbookid:0}},e.saveContact=function(){a.start(),o.save(e.formData).then(function(t){e.clearForm(),a.complete(),$("#contactbook").modal("hide"),r.custom("success","Contact Successfully Saved!","ContactBook!"),o.get().then(function(t){e.contacts=i.get(t),e.doPagination(e.contacts)},function(e){})},function(e){a.complete()})},e.editRow=function(t){a.start(),o.show(t).then(function(t){e.formData=i.get(t),a.complete(),$("#contactbook").modal("show")},function(e){})},e.deleteRow=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Contact?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?o.destroy(t).then(function(t){swal("Deleted!","Contact Successfully Deleted","success"),o.get().then(function(t){e.contacts=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})}}]),app.factory("Contact",["$http",function(e){return{get:function(){return e.get("sim/sut/contactbook")},show:function(t){return e.get("sim/sut/contactbook/"+t)},destroy:function(t){return e({method:"POST",url:"sim/sut/contactbook/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},save:function(t){return e({method:"POST",url:"sim/sut/contactbook",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},findlist:function(t){return e({method:"POST",url:"sim/sut/contactbook/findlist",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})}}}]),app.controller("reminderCtrl",["$scope","$http","$log","AccessFactory","Data","notify","cfpLoadingBar","$state","Reminder",function(e,t,n,o,i,r,a,s,c){e.formData={smrreminderid:0,users:[]},a.start(),c.get().then(function(t){a.complete(),e.reminders=i.get(t),e.doPagination(e.reminders),console.log(e.reminders)},function(e){a.complete()}),e.doPagination=function(t){e.totalItems=t.length,e.currentPage=1,e.itemsPerPage=10,e.maxSize=5},e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},c.users().then(function(t){e.users=i.get(t)},function(e){}),e.clearForm=function(){$(".users").prop("checked",!1),e.formData={smrreminderid:0,users:[]}},e.submitReminder=function(){a.start(),c.save(e.formData).then(function(t){a.complete(),e.clearForm(),$(".users").prop("checked",!1),$("#remindModel").modal("hide"),r.custom("success","Reminder Successfully Saved!","Reminder"),c.get().then(function(t){e.reminders=i.get(t),e.doPagination(e.reminders)},function(e){n.info(e)})},function(e){a.complete(),r.custom("error","Error Found While Saving!","Reminder")})},e.editRow=function(t){a.start(),c.show(t).then(function(t){e.formData=i.get(t),angular.forEach(e.formData.users,function(e){angular.element(document).ready(function(){$("input:checkbox[value="+e.uruserid+"]").prop("checked",!0)})}),a.complete(),$("#remindModel").modal("show")},function(e){a.complete(),r.custom("error","Error Found!","Reminder")})},e.deleteReminder=function(t){swal({title:"Are you sure?",text:"Do You Want To Delete This Reminder?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(n){n?c.destroy(t).then(function(t){$("#remindModel").modal("hide"),swal("Deleted!","Reminder Successfully Deleted","success"),c.get().then(function(t){e.reminders=i.get(t)},function(e){})},function(e){swal("Cancelled","Can't Delete Please Contact Administrator","error")}):swal("Cancelled","Terminated The Process","error")})},angular.element(document).ready(function(){$(document).on("change",".users",function(){if(this.checked)"0"==e.formData.smrreminderid?(console.log(e.formData),e.formData.users.push({uruserreminderid:"0",urreminderid:e.formData.smrreminderid,uruserid:$(this).data("id")})):e.formData.users.push({uruserreminderid:"0",urreminderid:e.formData.smrreminderid,uruserid:$(this).data("id")});else for(var t=0;t<e.formData.users.length;t++)e.formData.users[t].uruserid==$(this).data("id")&&e.formData.users.splice(t,1)})})}]),app.factory("Reminder",["$http",function(e){return{get:function(){return e.get("sim/sut/reminder")},show:function(t){return e.get("sim/sut/reminder/"+t)},save:function(t){return e({method:"POST",url:"sim/sut/reminder",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)})},destroy:function(t){return e({method:"POST",url:"sim/sut/reminder/"+t,headers:{"Content-Type":"application/json","X-HTTP-Method-Override":"DELETE"}})},test:function(e){return e},users:function(){return e.get("sim/sap/user/ddmenu")},Departments:function(t){return e.get("sim/hr/department/ddmenu")}}}]);